<!doctype html>
<html lang="zh-TW" version="1.52.33515-hotfix-v1-52-nfu-49d62c94" host="https://iclass.tku.edu.tw:443/" delivery-org="TKU">
<head>
<script>
    var sentryClientKey = "";
    sentryClientKey = /^http/.test(sentryClientKey) ? sentryClientKey : '';

    var CONFIGS = {
       "assetsPath": "",
       "sentryClientKey": sentryClientKey,
       "apm": {"DEBUG": false, "ENABLE_APM": true, "ENVIRONMENT": "prod-tku \u6de1\u6c5f\u5927\u5b78", "SECRET_TOKEN": "qqEAYoVJ7ocKrAsrJH8rKwc7", "SERVER_URL": "https://apm.tronclass.com", "SERVICE_NAME": "lms-web", "TRANSACTION_SAMPLE_RATE": 0.1}
    }
</script>        <link ref="preload" href="/static/runtime~js/lms-main-70b18c2c.js" as=script>
<link ref="preload" href="/static/js/lms-main-ff4b2227.js" as=script>
<link ref="preload" href="/static/js/lms-main-24fe9c68.css" as=style>
<style>body{display: none}</style><meta http-equiv="content-type" content="text/html" charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta name="robots" content="index, follow">
<meta http-equiv="Cache-Control" content="no-transform">    <title>iClass</title>
    <link rel="shortcut icon" href="/static/assets/images/favicon-b420ac72.ico">
    <!-- Global site tag (gtag.js) - Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js"></script>


        <link rel="stylesheet" href="/static/29375-0e81e8c3.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-base-3356f4bb.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/83892-1f6a18c7.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-lms-main-ff882e7d.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-30349872-f55be9d3.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-2c5d22db-ff4c1042.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-1f472754-4979dd03.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-ce409320-340c3ec9.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/89421-f48ffedc.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/js/lms-main-24fe9c68.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-iview-64133065.css" media="none" onload="if(media!='all')media='all'"></link>

    <link rel="dns-prefetch" href="https://js-agent.newrelic.com">
    <link rel="dns-prefetch" href="https://bam.nr-data.net">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    

</head>
<body -ng-app="user:course" ng-strict-di on-modal-state-change ng-init="isInstructorView = false;
                                                 org_plan_trial='None';
                                                 storageType='S3';
                                                 isIE9CannotUploadFileMsg='您的瀏覽器版本過低，無法上傳文件。請升級瀏覽器，或者使用其他瀏覽器上傳文件';
                                                 weekDayIso={1: '一',2: '二',3: '三',4: '四',5: '五',6: '六', 7: '日'};"
      class=' mathjax-ignore'>

<!-- 自定义主题色 -->


    <div class="wrapper ">
<!--[if IE 9]>
<div class="header-warning unsupport-browser">
    <div class="icon icon-unsupport-browser"></div>
    <span>
        您的瀏覽器版本過低，訪問中可能會出現問題。請升級瀏覽器或使用其他瀏覽器訪問
    </span>
</div>
<![endif]--><div id="announcement">
    <vue-announcement v-for="i in announcements" :announcement="i" :key="i.id"></vue-announcement>
</div><div id="alertMessages">
    <vue-alert-messages @close-modal="closeModal" v-if="allMessages" v-for="modal of modals" :messages="modal.messages" :modal="!modal.index"></vue-alert-messages>
</div><div ng-controller="HeaderWarningController"
     ng-init="warningVersionExpire='請重新整理瀏覽器。'">
        <div id="mobile-browser-warning" class="header-warning mobile-browser-warning ng-cloak" ng-if="ui.showMobileDeviceWarning"
             ng-style="{'width': ui.warningWidth}">
            <i class="font font-warning"></i>
            <span ng-if="ui.isIOS">
                建議您改用電腦登入本平台，或安裝專用 App 繼續使用。透過行動載具的瀏覽器使用本平台，可能造成部分功能無法完整運行。
            </span>
            <span ng-if="!ui.isIOS">
                建議您改用電腦登入本平台，或安裝專用 App 繼續使用。透過行動載具的瀏覽器使用本平台，可能造成部分功能無法完整運行。
            </span>
            <a class="close-button" ng-click="dismissMobileBrowserWarning()" style="">
                <i class="icon icon-verification-email-close icon-verification-email-close-active"></i>
            </a>
        </div>
</div>
<span
  id="userId"
  data-id="528655"
  value="528655"
  class="ui-helper-hidden-accessible"
></span>
<span id="isVisitor" data-value="" class="ui-helper-hidden-accessible"></span>
<input type="hidden" id="dashboardTracking" value="False" />
<span
  id="notificationServerUrl"
  data-url="/ntf"
  class="ui-helper-hidden-accessible"
></span>
<input type="hidden" id="courseId" value="" />
<input
  type="hidden"
  id="enrollmentIsInstructor"
  value=""
/>
<input
  type="hidden"
  id="enrollmentIsInstructorAssistant"
  value=""
/>

<input
  type="hidden"
  id="enrollmentIsStudent"
  value=""
/>
<input type="hidden" id="isSimulatingInCourse" value="False" />
<input type="hidden" id="showNickname" value="False" />

<input type="hidden" id="orgId" value="1" />
    <input type="hidden" id="userRole" value="Instructor">
 <input type="hidden" id="dotdotdotToggleCollapseI18n" ng-init="dotdotdotToggleCollapseI18n='收起'"> <input type="hidden" id="dotdotdotToggleExpandI18n" ng-init="dotdotdotToggleExpandI18n='更多...'">
<root-scope-variable name="lang" value="zh-TW"></root-scope-variable>
<root-scope-variable name="orgId" value="1"></root-scope-variable>
<root-scope-variable name="currentOrgTip" value="本機構"></root-scope-variable>
<script>
    var globalData = {
        user: {
            id: 528655,
            name: "陳勇汀",
            userNo: "162132",
            orgId: 1,
            mobile: "None",
            orgName: "淡江大學",
            orgCode: "tku",
        },
        dept: {
            id: "833",
            name: "資圖系",
            code: "TABX",
        },
        isOpenUniversity: false,
        courseRoles: [""],
        deliveryOrg: "TKU",
        faceServiceType: "None",
        enableLoginCheck: false,
        enableLoginRollcallCheck: false,
    }
</script>
<script>
    var featureToggles = {
        "class_mode_casting": true,
        "ongoing_course": true,
        "face_recognition_service": false,
        "face_photo_check_service": false,
        "inclass.user_action_track": false,
        "lesson_resource": false,
        "cloud_classroom": false,
        "onlineTeaching": false,
        "customize_i18n": false,
        "course_end_date_filter": false,
        "vocabulary": false,
        "wps_preview": false,
        "yz_office_preview": false,
        "editorActivityRefer": false,
        "lazyLoadCourseSection": false,
        "courseIndexDateFilter": false,
        "outcomeBasedEducation": false,
        "water_mark_by_vue_multi_player": false,
        "enableProgram": false,
        "examInvigilation": false,
        "simditor_embed_video": false,
        "simditor_attachment": false,
        "course_module_required": false,
        "publishScoreOfPartialStudents": false,
        "courseNeedPublish": false,
        "sortVideoAnalysis": false,
        "zoom": false,
        "microsoftTeamsMeeting": true,
        "welink": false,
        "tencentMeeting": false,
        "classin": false,
        "lectureLive": false,
        "webexMeeting": false,
        "enableAuditorCourseRole": false,
        "enableDingTalkChat": false,
        "homeworkDuplicateDetect": false
    }
</script>

<root-scope-variable name="avatarBigUrl"
                     value="https://iclass.tku.edu.tw:443/api/uploads/13650538/modified-image?thumbnail=200x200&amp;crop_box=0,0,187,187">
</root-scope-variable>
<root-scope-variable name="avatarSmallUrl" value="https://iclass.tku.edu.tw:443/api/uploads/13650538/modified-image?thumbnail=32x32&amp;crop_box=0,0,187,187"></root-scope-variable>
<root-scope-variable name="currentUserName" value="陳勇汀"></root-scope-variable>
<root-scope-variable name="firstChildTeachingClassesPage"
                     value="">
</root-scope-variable>
<div class="header header-autocollapse gtm-category" data-category="tronclass-header" ng-controller="HeaderCtrl"
     ng-init="userCurrentName='陳勇汀'; orgName='淡江大學'; deliveryOrg='TKU';
              orgLogoUrl='https://iclass.tku.edu.tw:443/api/uploads/131309/modified-image?thumbnail=0x272'; orgShowName='True'; orgShowLogo='True';
              langNames={'zh-TW': '繁體中文', 'zh-CN': '简体中文', 'zh-MO': '繁體中文 (澳門)', 'en-US': 'English (US)', 'en-GB': 'English (UK)', 'th-TH': 'ภาษาไทย'};" ng-cloak>

            <div class="sites-menu-entry left hide-in-small-size">
                <a href="/user/sites-menu">
                <span>
                <i class="icon icon-sites-menu"></i>
                </span>
                </a>
            </div>
        <div class="layout-row">
            <a href="/" ng-cloak>
<img class="logo" ng-src="[[ getOrgLogo() ]]" ng-if="getOrgShowLogo() == 'True' && getOrgLogo()"/>
<i class="logo default" ng-if="getOrgShowLogo() == 'True' && !getOrgLogo()"></i>
<div class="school-name truncate-text" ng-show="getOrgShowName() == 'True'">
    <span tipsy="getOrgName()" ng-bind="getOrgName()"></span>
</div>            </a>
    <li class="public-course autocollapse-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
        <a class="resources header-item" ng-href="/public-course#/all">發現課程</a>
    </li>










            <ul class="menu layout-menu">





    <li class="header-item hide-in-small-size hide-in-middle-size navigation"
        ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
    <a ng-click="showNavigationList()" href="javascript:void(0)" onclick="return false;" class="entry" ng-blur="hideNavigationList()">
        我的主頁
        <i class="icon font font-down-arrow"></i>
    </a>

<div class="dropdown-list ng-cloak gtm-category" data-category="顶部导航" ng-show="ui.showNavigationList">
    <ul ng-mouseleave="ui.inNavigationList=false" ng-mouseenter="ui.inNavigationList=true">
        <li class="gtm-label" data-label="首页">
            <a href="/user/index" target="_self">首頁</a>
        </li>
        <li class="gtm-label" data-label="我的课程">
            <a href="/user/courses" target="_self">我的課程</a>
        </li>
        <li class="gtm-label" data-label="我的资源">
            <a href="/user/resources/files" target="_self">
                我的資源
            </a>
        </li>
    </ul>
</div>    </li>
    <li class="header-item hide-in-small-size hide-in-middle-size text-title"
        ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}" ng-if="firstChildTeachingClassesPage">
        <a class="dashboard" ng-href="[[firstChildTeachingClassesPage]]">我的主頁</a>
    </li>
<li class="header-vertical-split-line  header-item"></li>
    <li class="autocollapse-item header-item text-title hide-in-small-size hide-in-middle-size"
        ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">

        <a ng-click="toggleCalendar()">
            <i class="icon font font-header-calendar" style="font-size: 17px;"></i>
        </a>
    </li>


<li class="notifications header-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
<script id="notification-list-server-data" type="application/json">
    {
        "teachingUnitNames": {
            "course": "課程",
            "teaching_class": "班級"
        },
        "teachingUnitRoleNames": {
            "student": "學生",
            "instructor": "教師",
            "instructor_assistant": "助教"
        },
        "notificationTypesAndText": {
            "material": "參考檔案",
            "web_link": "線上連結",
            "online_video": "影音教材",
            "slide": "微課程",
            "lesson": "錄影教材",
            "homework": "作業",
            "forum": "討論區",
            "chatroom": "iSlide 直播",
            "questionnaire": "問卷調查",
            "page": "頁面",
            "course_invite": "課程邀請",
            "scorm": "SCORM"
        },
        "weeklyDayTranslateForEnglish": {
            "一": "Mon",
            "二": "Tue",
            "三": "Wed",
            "四": "Thu",
            "五": "Fri",
            "六": "Sat",
            "日": "Sun"
        }
    }
</script>

<div id="notification_container">
    <translation :keys="{'view_all': '查看全部',
                        'no_notification': '暫無動態'}">
    </translation>
    <notification-container></notification-container>
</div></li>
    <li class="manual header-item autocollapse-item hide-in-middle-size"
         ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}"
         ng-controller="ManualListController" ng-init="manualUrlDict={
                 'sysadmin': 'https://tc-media.tku.edu.tw/manual/TronclassManual_System_Admin.pdf',
                 'admin': 'https://tc-media.tku.edu.tw/manual/TronclassManual_Administrator.pdf',
                 'instructor': 'https://tc-media.tku.edu.tw/manual/TronclassManual_Teacher.pdf',
                 'student': 'https://tc-media.tku.edu.tw/manual/TronclassManual_Student.pdf',
                 'app': 'https://tc-media.tku.edu.tw/manual/TronclassManual_App.pdf',
                 'tutorial_video': 'https://tc-media.tku.edu.tw/manual/TronclassManual_Tutorial_Video.pdf',
                 'faq': 'https://support.tronclass.com'};">

<div id="manual-viewer-popup" class="manual-viewer popup-1080 reveal-modal popup-area" resetable data-reveal popup-center-location>
    <div class="popup-content" ng-if="manualType">
        <div class="popup-header">
            <span ng-if="manualType=='sysadmin'">管理員版</span>
            <span ng-if="manualType=='admin'">教務版</span>
            <span ng-if="manualType=='instructor'">教師版</span>
            <span ng-if="manualType=='student'">學生版</span>
            <span ng-if="manualType=='app'">App</span>
            <span ng-if="manualType=='tutorial_video'">教學影片</span>
            <a class="right" close-popup="manual-viewer-popup">
                <i class="font font-close"></i>
            </a>
        </div>

        <div id="manual-viewer" class="main-area file-previewer" ng-if='manualUrl'>
            <div class="reader-wrapper">
                <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0"
                        ng-src="[[trustAsResourceUrl(manualUrl)]]">
                </iframe>
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>            </div>
        </div>

    </div>
</div>
        <a class="entry" ng-click="showManualList()" href="javascript:void(0)" onclick="return false;"
           ng-blur="hideManualList()">
            <i class="icon font font-header-help" style="font-size: 17px;"></i>
        </a>
        <div class="dropdown-list ng-cloak" ng-show="ui.showManualList"
             ng-mouseleave="ui.inManualList=false" ng-mouseenter="ui.inManualList=true">
            <ul>

                    <li>
                        <a ng-click="selectManual('instructor')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('instructor')">教師版</a>
                        <a target="_blank" href="[[manualUrlDict.instructor]]"
                           ng-if="isHtmlManual('instructor')">教師版</a>
                    </li>
                    <li>
                        <a ng-click="selectManual('student')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('student')">學生版</a>
                        <a target="_blank" href="[[manualUrlDict.student]]"
                           ng-if="isHtmlManual('student')">學生版</a>
                    </li>

                    <li>
                        <a ng-click="selectManual('tutorial_video')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('tutorial_video')">教學影片</a>
                        <a target="_blank" href="[[manualUrlDict.tutorial_video]]"
                           ng-if="isHtmlManual('tutorial_video')">教學影片</a>
                    </li>
                <li ng-if="false">
                    <a ng-click="selectManual('app')" reveal-modal="manual-viewer-popup"
                       ng-if="!isHtmlManual('app')">App</a>
                    <a target="_blank" href="[[manualUrlDict.app]]"
                       ng-if="isHtmlManual('app')">App</a>
                </li>
                    <li>
                        <a target="_blank" href="[[manualUrlDict.faq]]">幫助中心</a>
                    </li>
            </ul>
        </div>
    </li>
<li class="header-vertical-split-line  header-item"></li>

<li class="profile header-item hide-in-small-size hide-in-middle-size"
    ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
    <a href="javascript:void(0)" onclick="return false;"
       class="entry profile-item" ng-click="showUserOperationList($event)" ng-blur="hideUserOperationList()">
        <div class="avatar">
            <avatar src="avatarSmallUrl"></avatar>
        </div>
        <div class="current-user-name truncate-text">
            <span id="userCurrentName" tipsy="currentUserName" ng-bind="currentUserName"></span>
        </div>
        <i class="icon font font-down-arrow"></i>
    </a>

    <div class="dropdown-list ng-cloak" ng-show="ui.showOperList">
        <div class="user-dropdown-detail">
            <div class="avatar">
                <avatar src="avatarSmallUrl"></avatar>
            </div>
            <div class="user-info">
                <div class="user-name" ng-bind="currentUserName"></div>
                <div class="user-no">162132</div>
            </div>
        </div>
        <ul ng-mouseleave="ui.inOperList=false" ng-mouseenter="ui.inOperList=true"
            class="autocollapse-container" has-second-level-menu expand-left="1">
            <li class="operation operation-view-profile dropdown-item">
                <a ng-href="/user/settings" target="_self">個人設置</a>
            </li>
            <li class="operation operation-view-profile dropdown-item">
                <a href="javascript:void(0)" onclick="return false;" class="entry">
                    APP
                </a>
                <i class="icon font font-arrow-right"></i>
                <ul class="second-level">
                    <div class="app-QRCode ng-cloak" ng-class="{'app-zju': 'TKU' == 'ZJU' }"
                         ng-init="cloudType='private'; locale = 'zh-TW'">
                                <qrcode class="QRCode" size="110" version="6" data="https://iclass.tku.edu.tw:443/market"></qrcode>
                            <span>掃描 QR Code 下載 App</span>
                    </div>
                </ul>
            </li>
            <li class="operation dropdown-item" >
                <a>繁體中文</a>
                <i class="icon font font-arrow-right"></i>
                <ul class="second-level">
                    <li class="language" ng-repeat="lang in ui.langList">
                        <a ng-click="changeLanguage(lang)" ng-bind="langNames[lang]"></a>
                    </li>
                </ul>
            </li>
            <li class="split-line"></li>
            <li class="operation operation-logout dropdown-item">
                    <a ng-href="/logout">登出</a>
            </li>
        </ul>
    </div>
</li>
<div class="calendar-container" ng-if="showCalendar">
    <a class="right close" ng-click="toggleCalendar()"><i class="font font-close-bold"></i></a>
<div ng-controller="CalendarController"
     before-controller="i18nMessage={'dataRequired': '此欄位為必填。', 'createText': '新增'};
     calendarViewMap={
         'event': '行事曆',
         'timetable': '課程表',
         'meeting':'直播公開課',
         'instructionMeeting':'教學研討(會議)',
         'cloudClassroom':'騰訊會議',
         'all': '全部'
        };
     weekDayMap={0: '週日', 1: '週一', 2: '週二', 3: '週三', 4: '週四', 5: '週五', 6: '週六', 7: '週日'};
     isTimetableToggleOpen=false;isOpenUniversity=false;
     isStudent=false; isMasterOrg=true;
     isTencentMeetingToggleOpen=false;isInstructionTeamToggleOpen=false;
     isCloudClassroomToggleOpen=false;">
    <div id="calendar" class="calendar" ui-calendar="calendarOptions" ng-model="eventSources"></div>
    <input id="addText" type="hidden" value="新增">
    <input id="moreText" type="hidden" value="查看剩餘 {0} 項">
    <input id="editEventText" type="hidden" value="編輯">
    <input id="deleteEventText" type="hidden" value="刪除">
    <input id="deleteEventTitle" type="hidden" value="刪除事件">
    <input id="deleteEventConfirmText" type="hidden" value="確定刪除本事件？刪除後不可復原，事件將由發佈對象的日曆上移除">
    <input id="deleteTimetableTitle" type="hidden" value="刪除課程表">
    <input id="currentUserPhone" type="hidden" value="None">
    <input id="deleteMeetingTitle" type="hidden" value="删除直播">
    <input id="deleteMeetingText" type="hidden" value="確定刪除本直播活動？刪除後不可復原，直播活動將由發佈對象的日曆上移除">
<div id="event-popup" class="reveal-modal popup-area popup-900" data-reveal resetable ng-controller="CalendarEventController">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-if="!event.id">新增事件</span>
            <span ng-if="event.id">編輯事件</span>
            <a class="right" close-popup="event-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <form name="event_form" server-validated class="event-form">
                <div class="form-items [[lang]]">
                    <div class="item">
                        <div class="label">
                            <label class="required">標題</label>
                        </div>
                        <div class="input">
                            <input type="text" name="title" ng-model="event.title" server-validated/>
                        </div>
                        <span error-for="title"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">時間</label>
                        </div>
                        <div class="input event-time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="start_time" ng-attr-id="event-start-time"
                                       ng-model="event.start_time"
                                       server-validated datetimepicker no-time readonly ng-if="event.all_day"/>
                                <input type="text" name="start_time" ng-attr-id="event-start-time"
                                       ng-model="event.start_time"
                                       server-validated datetimepicker readonly ng-if="!event.all_day"/>
                                <label for="event-start-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <i class="font font-tree-collapsed"></i>
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="end_time" ng-attr-id="event-end-time"
                                       ng-model="event.end_time"
                                       server-validated datetimepicker no-time readonly ng-if="event.all_day"/>
                                <input type="text" name="end_time" ng-attr-id="event-end-time"
                                       ng-model="event.end_time"
                                       server-validated datetimepicker readonly ng-if="!event.all_day"/>
                                <label for="event-end-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <label>
                                <input type="checkbox" name="all_day" ng-model="event.all_day" server-validated
                                       ng-change="changeAllDay()"/>
                                全天
                            </label>
                        </div>
                        <span error-for="start_time"></span>
                        <span error-for="end_time"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>地點</label>
                        </div>
                        <div class="input">
                            <input type="text" name="location" ng-model="event.location" server-validated/>
                        </div>
                        <span error-for="location"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>說明</label>
                        </div>
                        <div class="input">
                            <textarea sim-editor name="description"
                                      ng-model="event.description"
                                      rows="6" maxlength="2000"
                                      server-validated>
                            </textarea>
                        </div>
                        <span error-for="description"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>附件</label>
                        </div>
                        <div class="input upload-wrapper" name="uploads" ng-model="uploads" server-validated>
    <div class="file-upload">
        <div class="select-file"  ng-class="{'select-file': !ui.hideAttachmentList, 'picture-select-file': ui.hideAttachmentList}">
            <button type="button" reveal-modal="file-select" on-file-selected="addFiles" file-select-scope-id="[[ fileSelectScopeId ]]">
                <i class="font font-file-select"></i><span>新增檔案</span>
            </button>
        </div>
        <div ng-if="!ui.hideAttachmentList">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>    </div>
</div>        </div>
    </div>
                        </div>
                        <div class="error">
                            <span error-for="uploads"></span>
                        </div>
                    </div>
                    <div class="item" ng-show="showTargetType()">
                        <div class="label">
                            <label>發佈到</label>
                        </div>
                        <div class="input">
                            <div class="select2-wrapper target-type">
                                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                        ng-model="event.target_type"
                                        ng-change="changeTargetType()">
                                    <option value="self">自己</option>
                                        <option value="course">課程</option>
                                </select>
                            </div>
                        </div>
                    </div>
                        <div class="item" ng-show="event.target_type == 'course'">
                            <div class="label">
                                <label class="required">選擇課程</label>
                            </div>
                            <div class="input">
                                <div class="select2-wrapper course">
                                    <select ui-select2="{placeholder: '選擇課程'}"
                                            ng-model="target_data.course_id"
                                            ng-change="changeCourse()"
                                            name="target_data_course_id">
                                        <option value=""></option>
                                        <option ng-repeat="course in ui.courses"
                                                ng-value="course.id" ng-bind="course.display_text"></option>
                                    </select>
                                </div>
                            </div>
                            <span error-for="target_data_course_id"></span>
                        </div>
                        <div class="item" ng-show="event.target_type == 'course' && target_data.course_id">
                            <div class="label">
                                <label>發佈對象</label>
                            </div>
                            <div class="input">
                                <select id="course-target-select" multi-select multiple="multiple"
                                        data-title="全部" ng-model="target_data.course_targets">
                                    <option ng-repeat="t in ui.courseTargets | orderBy: 'id'"
                                            ng-selected="target_data.course_targets.includes(t.id)"
                                            ng-value="t.id" ng-bind="t.name"></option>
                                </select>
                            </div>
                        </div>
                    <div class="item">
                        <div class="label">
                            <label>提醒</label>
                        </div>
                        <div class="input">
                            <div class="choice">
                                <label>
                                    <input type="radio" name="hasAlert"
                                           ng-model="ui.hasAlert"
                                           ng-change="changeHasAlert()"
                                           ng-value="0"/>
                                    無
                                </label>
                                <label>
                                    <input type="radio" name="hasAlert"
                                           ng-model="ui.hasAlert"
                                           ng-change="changeHasAlert()"
                                           ng-value="1"/>
                                    到期提醒
                                </label>
                            </div>
                            <div class="select2-wrapper alert" ng-show="ui.hasAlert">
                                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                        ng-model="event.alert_id">
                                    <option ng-repeat="alert in ui.alerts"
                                            ng-value="alert.id" ng-bind="alert.text"></option>
                                </select>
                            </div>
                            <label ng-if="ui.hasAlert">
                                <input type="checkbox" name="send_alert_email" ng-model="event.send_alert_email" server-validated/>
                                同時 Email 通知
                            </label>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>提示顏色</label>
                        </div>
                        <div class="input">
                            <div class="color-chooser">
                                <input type="radio" name="color" ng-model="event.color" ng-value="'blue'" id="blue" class="blue">
                                <label for="blue" class="blue"><span></span></label>
                                <input type="radio" name="color" ng-model="event.color" ng-value="'yellow'" id="yellow" class="yellow">
                                <label for="yellow" class="yellow"><span></span></label>
                                <input type="radio" name="color" ng-model="event.color" ng-value="'red'" id="red" class="red">
                                <label for="red" class="red"><span></span></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-buttons text-center">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    <button class="button button-green medium" ng-hide="loading" ng-click="save()"
                            type="button">儲存</button>
                    <button type="button" class="button button-grey medium" ng-hide="loading"
                            close-popup="event-popup">取消</button>
                </div>
            </form>
        </div>
    </div>
<div class="hide">
    <span id="selected-text">已選擇 # 個&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="selected-text-all">全部&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="filter-placeholder">請輸入關鍵字</span>
</div></div><div id="timetable-popup" class="reveal-modal popup-area popup-600" data-reveal resetable
     ng-controller="CalendarTimetableController">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-if="!timetable.id">新建課程表</span>
            <span ng-if="timetable.id">編輯課程表</span>
            <a class="right" close-popup="timetable-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <form name="timetableForm" server-validated>
                <div class="form-items [[lang]]">
                    <div class="item" ng-if="!timetable.id">
                        <div class="label">
                            <label class="required">選擇課程</label>
                        </div>
                        <div class="input">
                            <div class="select2-wrapper course">
                                <select ui-select2="{placeholder: '選擇課程'}"
                                        ng-model="timetable.course_id"
                                        ng-change="changeCourse()"
                                        name="course_id">
                                    <option value=""></option>
                                    <option ng-repeat="course in courses"
                                            ng-value="course.id" ng-bind="course.display_text"></option>
                                </select>
                            </div>
                        </div>
                        <span error-for="course_id"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">課程名稱</label>
                        </div>
                        <div class="input">
                            <input type="text" name="course_title" ng-model="timetable.course_title" maxlength="255" server-validated/>
                        </div>
                        <span error-for="course_title"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>授課教師</label>
                        </div>
                        <div class="input">
                            <input type="text" name="instructors_names" ng-model="timetable.instructors_names" maxlength="255" server-validated/>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">上課時間</label>
                        </div>
                        <div class="input time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="start_time" id="timetable-start-time" datetimepicker
                                       ng-model="timetable.start_time" server-validated />
                                <label for="timetable-start-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <i class="font font-tree-collapsed"></i>
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="end_time" id="timetable-end-time" datetimepicker
                                       ng-model="timetable.end_time" server-validated />
                                <label for="timetable-end-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                        </div>
                        <span error-for="start_time"></span>
                        <span error-for="end_time"></span>
                    </div>
                    <div class="item" ng-if="timetable.id">
                        <div class="label">
                            <label>範圍</label>
                        </div>
                        <div class="input">
                            <div class="choice">
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="current"/>
                                    本節次
                                </label>
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="current_and_after"/>
                                    本節次及後續節次
                                </label>
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="all"/>
                                    所有節次
                                </label>
                            </div>
                        </div>
                    </div>
                    <div ng-if="!timetable.id || timetable.update_scope != 'current'">
                        <div class="item">
                            <div class="label">
                                <label>重複頻率</label>
                            </div>
                            <div class="input frequency">
                                <div class="select2-wrapper repeat-type">
                                    <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                            ng-model="timetable.repeat_type">
                                        <option value="no_repeat">不重複</option>
                                        <option value="day">每天</option>
                                        <option value="week">每週</option>
                                        <option value="custom">自訂</option>
                                    </select>
                                </div>
                                <div ng-if="timetable.repeat_type=='custom'">
                                    <input type="text" name="repeat_frequency" ng-model="timetable.repeat_frequency"
                                           data-min="1" integer-limit server-validated />
                                    <span>週</span>
                                    <span class="frequency-error" error-for="repeat_frequency"></span>
                                </div>
                            </div>
                        </div>
                        <div class="item" ng-if="timetable.repeat_type=='week' || timetable.repeat_type=='custom'">
                            <div class="label">
                                <label>重複時間</label>
                            </div>
                            <div class="input">
                                <div class="weekly-day" ng-repeat="day in weeklyDays">
                                    <input type="checkbox" name="days" ng-checked="timetable.repeat_weekly_days.indexOf(day.val) > -1">
                                    <span ng-bind="day.name" ng-click="toggleSelectDay(day.val)"></span>
                                </div>
                            </div>
                            <div ng-if="showWeeklyDaysError" class="error">此欄位為必填。</div>
                        </div>
                        <div class="item" ng-if="timetable.repeat_type!='no_repeat'">
                            <div class="label">
                                <label class="required">結束時間</label>
                            </div>
                            <div class="input course-end-date">
                                <div class="datetimepicker-wrapper">
                                    <input type="text" name="repeat_end_date" id="repeat-end-date" datepicker
                                           ng-model="timetable.repeat_end_date" server-validated />
                                    <label for="repeat-end-date" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                                </div>
                            </div>
                            <span ng-if="timetable.course_end_date">課程結束日期：<span ng-bind="timetable.course_end_date"></span></span>
                            <span error-for="repeat_end_date"></span>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>地點</label>
                        </div>
                        <div class="input">
                            <input class="location" type="text" name="location" ng-model="timetable.location" maxlength="255" server-validated/>
                        </div>
                        <span error-for="location"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>說明</label>
                        </div>
                        <div class="input">
                            <textarea class="description" name="description" ng-model="timetable.description"
                                      maxlength="500" server-validated></textarea>
                        </div>
                        <span error-for="description"></span>
                    </div>
                    <div class="item color-wrapper">
                        <div class="label">
                            <label>提示顏色</label>
                        </div>
                        <div class="input">
                            <div class="color-picker">
                                <span class="default" ng-style="{'background-color': color}"
                                    ng-repeat="color in defaultColors" ng-click="selectColor(color)"></span>
                            </div>
                            <div class="custom-color clearfix">
                                <input class="left" type="text" ng-model="timetable.color" maxlength="7">
                                <span class="real-time-color left" ng-style="{'background-color': timetable.color}"></span>
                            </div>
                        </div>
                    </div>
                    <div class="item" ng-if="timetable.id">
                        <div class="label">
                            <label>發調課通知</label>
                        </div>
                        <div class="input">
                            <div class="choice send-ntf-choice">
                                <label>
                                    <input type="radio" name="sendNtf" ng-model="timetable.send_ntf" ng-value="false">
                                    否
                                </label>
                                <label>
                                    <input type="radio" name="sendNtf" ng-model="timetable.send_ntf" ng-value="true">
                                    是
                                </label>
                            </div>
                        </div>
                        <div class="input ntf-content-wrapper" ng-if="timetable.send_ntf">
                            <textarea class="ntf-content" name="ntf_content" ng-model="timetable.ntf_content" server-validated></textarea>
                        </div>
                        <span error-for="ntf_content"></span>
                    </div>
                </div>
                <div class="form-buttons text-center">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    <button class="button button-green medium" ng-hide="loading" ng-click="save()"
                            type="button">儲存</button>
                    <button type="button" class="button button-grey medium" ng-hide="loading"
                            close-popup="timetable-popup">取消</button>
                </div>
            </form>
        </div>
    </div>
</div><div id="calendar-meeting-popup" class="reveal-modal popup-area popup-900" data-reveal resetable
     ng-controller="CalendarMeetingController">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-if="!meeting.id">新增直播公開課</span>
            <span ng-if="meeting.id">編輯直播公開課</span>
            <a class="right" close-popup="calendar-meeting-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <form name="calendarMeetingForm" server-validated>
                <div class="form-items [[lang]]">
                    <div class="item">
                        <div class="label">
                            <label class="required">標題</label>
                        </div>
                        <div class="input">
                            <input type="text" name="title" ng-disabled="!can_edit" ng-model="meeting.title" server-validated/>
                        </div>
                        <span error-for="title"></span>
                    </div>

                    <div class="item">
                        <div class="label">
                            <label>簡介</label>
                        </div>
                        <div class="input">
                            <textarea sim-editor name="description"
                                      ng-model="meeting.data.description"
                                      sim-toolbar-extend-default="html"
                                      rows="6" maxlength="2000"
                                      server-validated>
                            </textarea>
                        </div>
                        <span error-for="description"></span>
                    </div>

                    <div class="item">
                        <div class="label">
                            <label class="required">範圍</label>
                        </div>
                        <div class="input">
                            <div class="select2-wrapper" ng-if="can_edit">
                                <select multi-select id="orgs-select" multiple="multiple" data-title="全部"
                                    ng-model="meeting.scope_org_ids">
                                    <option value="[[ org.id ]]" ng-repeat="org in orgs" ng-bind="org.name" ng-disabled="!can_edit"></option>
                                </select>
                            </div>
                            <div ng-if="!can_edit">
                                <div class="input">
                                    <textarea rows="3" disabled ng-model="scope_orgs"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="item">
                        <div class="label">
                            <label class="required">開始時間</label>
                        </div>
                        <div class="input event-time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="start_time" ng-attr-id="event-start-time" ng-disabled="!can_edit"
                                       ng-model="meeting.start_time" server-validated datetimepicker/>
                                <label class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                        </div>
                        <span error-for="start_time"></span>
                    </div>

                    <div class="item">
                        <div class="label">
                            <label class="required">結束時間</label>
                        </div>
                        <div class="input event-time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="end_time" ng-disabled="!can_edit"
                                       ng-model="meeting.end_time" server-validated datetimepicker/>
                                <label class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                        </div>
                        <span error-for="end_time"></span>
                    </div>

                    <div class="item">
                        <div class="label">
                            <label>主持人</label>
                        </div>
                        <div class="input">
                            <span readonly ng-bind="meeting.host_user"/>
                        </div>
                    </div>
                </div>
                <div class="form-buttons text-center">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    <button class="button button-green medium" ng-hide="loading" ng-click="save()"
                            type="button">儲存</button>
                    <button type="button" class="button button-grey medium" ng-hide="loading"
                            close-popup="calendar-meeting-popup">取消</button>
                </div>
            </form>
        </div>
    </div>
<div class="hide">
    <span id="selected-text">已選擇 # 個&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="selected-text-all">全部&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="filter-placeholder">請輸入關鍵字</span>
</div></div><div id="calendar-detail-popup">
    <div class="title-container" ng-style="{'background-color': currentCalendar.data.color}">
        <div class="operations right" ng-init="userId=528655;">
            <a ng-if="currentCalendar.editable && currentCalendar.type !== 'cloudClassroom'" ng-hide="currentCalendar.data.audit_status === 'auditing'"
               ng-click="editCalendar(currentCalendar)">
                <i class="font font-edit"></i>
            </a>
            <a ng-if="currentCalendar.editable && currentCalendar.type !== 'cloudClassroom'" ng-hide="['auditing', 'agree'].includes(currentCalendar.data.audit_status)"
               ng-click="deleteCalendar(currentCalendar)">
                <i class="font font-delete"></i>
            </a>
            <a ng-click="closeCalendarDetailPopover()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="title truncate-text" ng-if="!['meeting', 'instructionMeeting', 'cloudClassroom'].includes(currentCalendar.type)">
            <span ng-bind="currentCalendar.title"></span>
        </div>
        <div class="title truncate-text status-box" ng-if="['meeting', 'instructionMeeting', 'cloudClassroom'].includes(currentCalendar.type)">
            <span ng-bind="currentCalendar.title"></span>
            <span class="audit-status" ng-if="currentCalendar.data.audit_status == 'auditing'">待審核</span>
            <span class="audit-status" ng-if="currentCalendar.data.audit_status == 'agree'">已通過</span>
            <span class="audit-status" ng-if="currentCalendar.data.audit_status == 'reject'">已拒絕</span>
        </div>
    </div>
    <div class="form-items [[lang]]">
        <div class="item">
            <div class="item-name">
                <i class="font font-calendar-clock"></i>時間
            </div>
            <div class="item-value">
                <div class="time-range"><span ng-bind="currentCalendar.timeRange"></span></div>
                <div class="all-day" ng-if="currentCalendar.allDay">全天</div>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.instructors_names">
            <div class="item-name">
                <i class="font font-calendar-teacher"></i>教師
            </div>
            <div class="item-value">
                <span class="instructors" ng-bind="currentCalendar.data.instructors_names"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.location">
            <div class="item-name">
                <i class="font font-calendar-location"></i>地點
            </div>
            <div class="item-value truncate-text">
                <span class="location" ng-bind-html="currentCalendar.data.location | linkify: '_blank'"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.course && currentCalendar.course.name">
            <div class="item-name">
                <i class="font font-course"></i>課程
            </div>
            <div class="item-value truncate-text">
                <span class="course" ng-bind="currentCalendar.course.name"></span>
            </div>
        </div>

        <div class="item" ng-if="['meeting', 'instructionMeeting', 'cloudClassroom'].includes(currentCalendar.type)">
            <div class="item-name">
                <i class="font font-host-user"></i>主持人
            </div>
            <div class="item-value truncate-text">
                <span class="location" ng-bind="currentCalendar.data.host_user.name"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.room && currentCalendar.room.room_name">
            <div class="item-name">
                <i class="font font-room"></i>教室
            </div>
            <div class="item-value">
               <span class="room" ng-bind="currentCalendar.room.room_name"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.description">
            <div class="item-name">
                <i class="font font-calendar-remark"></i>說明
            </div>
            <div class="item-value description">
                <span ng-bind-html="currentCalendar.data.description | sanitizeHtml" ng-if="currentCalendar.type == 'event' || ['meeting', 'instructionMeeting', 'cloudClassroom'].includes(currentCalendar.type)"></span>
                <span ng-bind-html="currentCalendar.data.description | linkify: '_blank'" ng-if="currentCalendar.type == 'timetable'"></span>
            </div>
        </div>
        <div class="item attachment-list">
            <div class="activity-attribute" ng-if="uploads.length">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>    </div>
</div>            </div>
        </div>
    </div>
    <div class="form-buttons text-center" ng-if="currentCalendar.type === 'meeting' && currentCalendar.data.audit_status != 'auditing'">
        <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}"
                ng-if="currentCalendar.data.audit_status == 'agree' && !currentCalendar.data.is_started" disabled type="button">進入直播</button>
        <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}"
                ng-if="currentCalendar.data.audit_status == 'agree' && currentCalendar.data.is_started && !currentCalendar.data.is_ended "
                ng-click="openMeeting(currentCalendar)" type="button">進入直播</button>
        <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}"
                ng-if="currentCalendar.data.audit_status == 'reject'" ng-click="editCalendar(currentCalendar)" type="button">再次繳交</button>
        <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}"
                ng-if="currentCalendar.data.audit_status == 'agree' && currentCalendar.data.replay_address"
                ng-click="viewLiveReplay(currentCalendar)" type="button">直播回看</button>
    </div>
    <div class="form-buttons text-center" ng-if="currentCalendar.type === 'instructionMeeting'">
        <a href="/course/[[ currentCalendar.course.id ]]/teaching-team#/meeting/[[ currentCalendar.id ]]" target="_blank">
            <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}" type="button">
                查看詳情
            </button>
        </a>
    </div>
<!--    <div class="form-buttons text-center" ng-if="currentCalendar.type === 'cloudClassroom'">-->
<!--        <a href="/course/[[ currentCalendar.course.id ]]/learning-activity/full-screen#/[[currentCalendar.id]]" target="_blank">-->
<!--            <button class="button medium" ng-style="{'background-color': currentCalendar.data.color}" type="button">-->
<!--                查看詳情-->
<!--            </button>-->
<!--        </a>-->
<!--    </div>-->
</div><div id="calendar-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal resetable>
    <div class="popup-content">
        <div class="popup-header">
            <span ng-bind="ui.titleBind"></span>
            <a class="right" close-popup="calendar-confirmation-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-if="ui.messageBind"><span ng-bind="ui.messageBind"></span></div>
            <div ng-if="!ui.messageBind">
                <div class="scope-label">範圍</div>
                <div class="scope-choice">
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="current"/>本節次
                    </label>
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="current_and_after"/>本節次及後續節次
                    </label>
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="all"/>所有節次
                    </label>
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="confirm()"
                        type="submit" ng-hide="loading">確認</button>
                <button class="button button-grey medium" close-popup="calendar-confirmation-popup"
                        type="button" ng-hide="loading">取消</button>
            </div>
        </div>
    </div>
</div></div></div>
            </ul>
        </div>
<div class="file-select popup-area reveal-modal" id="file-select" data-reveal resetable
     data-options="multiple_opened:true"
     before-controller="
     uploadZeroSizeFileErrorMessage='請勿上傳 0 Bytes 文件';
     uploadSizeLimitErrorMessage='抱歉，檔案大小超出限制';
     uploadFileFormatLimitErrorMessage='抱歉，不支援此檔案類型';"
     ng-init="
        is_lark_docs_open=false;
        useClientUploadFile=false;
        maxUploadSize=1073741824;
        userFreeSpace=-1849183595;
        hasStorageCapacity= true;
        isFileExtensionCheckEnable=false;">
    <div class="popup-content" ng-if="popupState.popupOpened" ng-controller="FileSelectController">
        <div class="popup-header">
            <span>選擇附件</span>
            <a class="right" ng-click="closePopup()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="tabs row">
                <li class="tab-title" ng-if="!model.context.lesson_resource_only && !model.context.repositoryOnly">
                    <a ng-class="{'active': model.tab == 'local'}" ng-click="changeTab('local')">本地上傳</a>
                </li>
                <li class="tab-title">
                    <a ng-class="{'active': model.tab == 'repository'}"
                       ng-click="changeTab('repository')">資源庫</a>
                </li>
                <li class="tab-title" ng-if="isShowLarkSpace() && is_lark_docs_open">
                    <a ng-class="{'active': model.tab == 'lark'}"
                       ng-click="changeTab('lark')">飛書(Lark)空間</a>
                </li>
            </div>
            <div class="tabs-content">
                    <div class="select-local-content select-content"
                         ng-if="model.tab == 'local' && !isIE9">
                        <div class="upload-area"
                             multiple="true"
                             ngf-drop="onFileSelect($files, 1073741824)"
                             ngf-drag-over-class="'dragover'">
                            <div class="select-file">
                                    <button class="button-select-file"
                                            ngf-select="onFileSelect($files, 1073741824)" multiple>
                                        <i class="font font-file-select"></i>
                                        <span>新增檔案</span>
                                    </button>
                                <button class="button-open-client"
                                        ng-if="useClientUploadFile"
                                        ng-click="openClient()">
                                    <i class="font font-chinamcloud"></i>
                                    <span>客户端上传</span>
                                    <i class="icon icon-tip" tipsy-html='yes'
                                       tipsy-literal="大视频建议使用客户端上传<br/>上传后请到资源库选取文件"></i>
                                </button>
                            </div>
                            <div class="size-limit">
                                <span>支援多個文件拖拽或點擊上傳，單個文件大小不能超過</span>
                                <span class="max-upload-size" ng-bind="1073741824|humanizeBytes"></span>
                            </div>
                            <div class="size-limit" ng-if="isFileExtensionCheckEnable">
                                目前系統支援的檔案格式
                                <i class="icon icon-tip" tipsy-class="gray" tipsy-html='yes' tipsy-follow-element-width="true"
                                   tipsy-literal="<p></p><p>影片格式：avi, wmv, mov, mp4, mpg, rm, rmvb, mkv, webm, flv, mp3,</br> wma, wav, m4a, m4v</p>
                                                  <p>音訊格式：mp3, wma, wav, m4a</p>
                                                  <p>圖片格式：jpg, jpeg, png, webp, gif, bmp, heic</p>
                                                  <p>檔案格式：txt, doc, docx, ppt, pptx, xls, xlsx, csv, pdf, rtf, odt, odp, ods</p>
                                                  <p>壓縮檔案格式：zip, rar, tar</p>">
                                </i>
                            </div>
                            <div class="size-limit">
                                上傳檔案為有加密時，將無法進行預覽
                            </div>
                        </div>
                    </div>
                    <div class="select-local-content select-content"
                         ng-if="model.tab == 'local' && isIE9">
                        <div class="select-file">
                            <button ngf-select="onFileSelect($files, 1073741824)" ng-disabled="isIE9CannotUploadFile()"
                                    multiple>選擇檔案</button>
                            <button class="button-open-client"
                                    ng-if="useClientUploadFile"
                                    ng-click="openClient()">
                                <i class="font font-chinamcloud"></i>
                                <span>客户端上传</span>
                                <i class="icon icon-tip" tipsy-html='yes'
                                   tipsy-literal="大视频建议使用客户端上传<br/>上传后请到资源库选取文件"></i>
                            </button>
                        </div>
                        <div class="size-limit">
                            <span>單個檔案最大上傳檔案大小：</span>
                            <span ng-bind="1073741824|humanizeBytes"></span>
                        </div>
                        <div class="html-msg" ng-show="isIE9CannotUploadFile()">
                            您的瀏覽器版本過低，無法上傳文件。請升級瀏覽器，或者使用其他瀏覽器上傳文件
                        </div>
                    </div>
                <div class="select-repository-content upload-content"
                     ng-if="model.tab == 'repository' || model.tab == 'third_part_resource'
                     || model.tab=='academic_learning_platform'"
                     ng-init="toggleAuditCourseResource = false">
<div class="file-type row" ng-if="model.context.lesson_resource_only">
    <li ng-class="active">錄影教材</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="關鍵字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>查詢</span>
            </a>
        </div>
    </li>
</div>

<div class="file-type row" ng-if="!model.context.lesson_resource_only">
    <li ng-class="{'active': model.fileType == 'all'}"
        ng-click="changeFileType('all')"
        ng-if="isAllowedFileType('all')">全部</li>
    <li ng-class="{'active': model.fileType == 'image', 'limited-file-type': isOnlyLimitedFileType('image')}"
        ng-click="changeFileType('image')"
        ng-if="isAllowedFileType('image')">圖片</li>
    <li ng-class="{'active': model.fileType == 'document', 'limited-file-type': isOnlyLimitedFileType('document')}"
        ng-click="changeFileType('document')"
        ng-if="isAllowedFileType('document')">檔案</li>

    <li ng-class="{'active': model.fileType == 'video', 'limited-file-type': isOnlyLimitedFileType('video')}"
        ng-click="changeFileType('video')"
        ng-if="isAllowedFileType('video')">影片</li>
        <li ng-class="{'active': model.fileType == 'video-quiz', 'limited-file-type': isOnlyLimitedFileType('video-quiz')}"
            ng-click="changeFileType('video-quiz')"
            ng-if="isAllowedFileType('video-quiz')">互動教材</li>

    <li ng-class="{'active': model.fileType == 'audio', 'limited-file-type': isOnlyLimitedFileType('audio')}"
        ng-click="changeFileType('audio')"
        ng-if="isAllowedFileType('audio')">音訊</li>
    <li ng-class="{'active': model.fileType == 'swf', 'limited-file-type': isOnlyLimitedFileType('swf')}"
        ng-click="changeFileType('swf')"
        ng-if="isAllowedFileType('swf')">Flash</li>
    <li ng-class="{'active': model.fileType == 'subject-lib'}"
        ng-click="changeFileType('subject-lib')"
        ng-if="isAllowedFileType('subject-lib')">題庫</li>
     <li ng-class="{'active': model.fileType == 'link', 'limited-file-type': isOnlyLimitedFileType('link')}"
        ng-click="changeFileType('link')"
        ng-if="isAllowedFileType('link')">連結</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="關鍵字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>查詢</span>
            </a>
        </div>
    </li>
</div>
<div class="go_to_prev_folder" ng-if="isAllowedFileType('all') && model.path.length > 0">
    <a ng-click="gotoPrev()">返回上一層</a>
</div>
<div class="row file-summary" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')">
    <div class="large-1 column">
        <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
               ng-if="!model.singleSelect"/>
    </div>
    <div class="large-3 columns file-name-label">
        資源名稱
    </div>
    <div class="columns selected-count" ng-class="{'large-12': !toggleAuditCourseResource, 'large-8': toggleAuditCourseResource}">
        <span ng-if="!model.singleSelect">（[["已選:  資料夾 {0}, 資源 {1}" | format:selectedCount() ]]）</span>
    </div>
    <div class="large-5 columns">
        <div class="view-mode right" ng-if="model.fileType == 'image'">
            <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                <i class="font font-thumbnail-view"></i>
            </a>
            <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                <i class="font font-list-view"></i>
            </a>
        </div>
    </div>
</div>
<div class="file-list" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')"
     ng-class="{'folder-pagination-list': model.pagination.totalPage > 1 && isAllowedFileType('all') && model.path.length > 0,
                'folder-list': model.pagination.totalPage <= 1 && isAllowedFileType('all') && model.path.length > 0,
                'file': model.pagination.totalPage <= 1 && !(isAllowedFileType('all') && model.path.length > 0)}">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div ng-repeat="upload in model.pagination.currentList">
        <div class="row file-list-item" ng-if="upload.is_folder" data-ng-click="!upload.selectable || toggleUploadClick(upload)">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload);"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i class="font font-file-[[fileTypeByExtension(upload)]]"></i>
            </div>
            <div class="columns file-name" ng-click="enterFolder(upload)" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div class="name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
                <div class="file-info">
                    <div class="created-at">
                        <span ng-bind="upload.created_at|datetime"></span>
                    </div>
                </div>
            </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上傳失敗</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="刪除"></i>
                </a>
            </div>
        </div>
        <label class="row file-list-item" ng-if="!upload.is_folder">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload)"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                   class="font font-file-[[fileTypeByExtension(upload)]]"></i>
                <i ng-if="upload.type == 'slide'" class="font font-slide"></i>
                <i ng-if="upload.type == 'subject-lib'" class="font font-resource-subject-lib"></i>
            </div>
            <div class="columns file-name" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div>
                    <span class="name truncate-text">
                        <span ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                              ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                        <span ng-if="upload.type == 'slide' || upload.type == 'subject-lib'"
                              ng-bind="upload.title" tipsy="upload.title"></span>
                    </span>
                    <span class="video-quiz-mark" ng-if="upload.type == 'video-quiz'">互動教材</span>
                    <span ng-if="upload.type != 'slide'" class="extension" ng-bind="upload.name|fileExtension"></span>
                    <span class="video-quiz-warning" ng-if="upload.type == 'video-quiz' && upload.uploads[0].deleted">影片已刪除</span>
                </div>
                <div class="file-info">
                    <div class="created-at">
                        <span ng-bind="upload.created_at|datetime"></span>
                    </div>
                    <div ng-if="upload.type != 'slide' && upload.type != 'subject-lib' && upload.type != 'link'" class="size">
                        <span>檔案大小</span>
                        <span ng-bind="upload.size|humanizeBytes"></span>
                    </div>
                    <div ng-if="upload.type == 'slide'">
                        <span>
                            時長:
                            <span ng-bind="upload.duration | formatTime"></span>
                        </span>
                    </div>
                    <div ng-if="upload.type == 'video-quiz' || upload.type == 'subject-lib'">
                        <span>
                            題目數:
                            <span ng-bind="upload.num_of_subjects"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上傳失敗</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="刪除"></i>
                </a>
            </div>
        </label>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您還沒有任何檔案
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合條件的檔案
    </div>
</div>
<div class="thumbnail-list" ng-if="model.fileType == 'image' && model.mode == 'thumbnail'">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div class="thumbnail-block">
        <div class="row file-summary clear">
            <div class="large-6 column">
                <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
                       ng-if="!model.singleSelect"/>
                <span ng-if="model.singleSelect">&nbsp</span>
            </div>
            <div class="large-26 columns">
                <div class="view-mode right">
                    <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                        <i class="font font-thumbnail-view"></i>
                    </a>
                    <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                        <i class="font font-list-view"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="clear">
            <div class="thumbnail-label left" ng-repeat="upload in model.pagination.currentList | orderBy: '-created_at'">
                <label>
                    <div class="thumbnail" ng-class="{'selected': upload.selected || upload.id == model.singleSelectedUpload.id, 'single-select': model.singleSelect}">
                        <input type="checkbox" class="thumbnail-input" ng-if="!model.singleSelect" ng-change="toggleUploadClick(upload)" ng-model="upload.selected">
                        <input type="radio" class="thumbnail-input" name="upload" ng-value="upload"
                               ng-model="model.singleSelectedUpload" ng-if="model.singleSelect"/>
                        <img ng-src="/api/third-part/uploads/[[upload.thumbnail.id]]/thumbnail" ng-if="upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/third-part/uploads/[[upload.id]]/preview" ng-if="upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                        <img class="fade" ng-src="/api/uploads/[[upload.thumbnail.id]]/thumbnail?preview=true" ng-if="!upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/uploads/[[upload.id]]/blob?preview=true" ng-if="!upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                    </div>
                </label>
                <div class="file-name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您還沒有任何檔案
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合條件的檔案
    </div>
</div>
<div class="row list-pager" ng-if="model.pagination.totalPage > 1">
    <ul>
        <li ng-show="model.pagination.currentPage > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage - 1)">
                <span>< 上一頁</span>
            </a>
        </li>
        <li class="first-page" ng-hide="model.pagination.currentPage <= 1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage <= 3">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="model.pagination.currentPage <= 2">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage - 1" ng-click="changePage(model.pagination.currentPage - 1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="model.pagination.currentPage"></a>
        </li>
        <li class="next-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 1">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage + 1" ng-click="changePage(model.pagination.currentPage + 1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage">
            <a class="small pager-button button-white" ng-bind="model.pagination.totalPage" ng-click="changePage(model.pagination.totalPage)"></a>
        </li>
        <li ng-show="model.pagination.currentPage < model.pagination.totalPage" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage+1)">
                <span>下一頁 ></span>
            </a>
        </li>
        <li class="custom-pager">
            <span>頁碼:</span>
            <input type="text" name='page' ng-model="model.pagination.inputPage" ng-change="model.verifyPageIndexInput" enter-press="changePage(model.pagination.inputPage)"/>
            <a class="button button-white" ng-click="changePage(model.pagination.inputPage)" ng-disabled="!model.pagination.inputPage">Go</a>
        </li>
    </ul>
</div>                </div>
                <div class="select-repository-content upload-content" ng-if="model.tab == 'lark'">
<div class="file-type row" ng-if="model.context.lesson_resource_only">
    <li ng-class="active">錄影教材</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="關鍵字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>查詢</span>
            </a>
        </div>
    </li>
</div>

<div class="go_to_prev_folder" ng-if="isAllowedFileType('all') && model.path.length > 0">
    <a ng-click="gotoPrev()">返回上一層</a>
</div>
<div class="row file-summary" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')">
    <div class="large-1 column">
        <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
               ng-if="!model.singleSelect"/>
    </div>
    <div class="large-3 columns file-name-label">
        資源名稱
    </div>
    <div class="columns selected-count" ng-class="{'large-12': !toggleAuditCourseResource, 'large-8': toggleAuditCourseResource}">
        <span ng-if="!model.singleSelect">（[["已選:  資料夾 {0}, 資源 {1}" | format:selectedCount() ]]）</span>
    </div>
    <div class="large-5 columns">
        <div class="view-mode right" ng-if="model.fileType == 'image'">
            <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                <i class="font font-thumbnail-view"></i>
            </a>
            <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                <i class="font font-list-view"></i>
            </a>
        </div>
    </div>
</div>
<div class="file-list lark-file-list" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')"
     ng-class="{'folder-pagination-list': model.pagination.totalPage > 1 && isAllowedFileType('all') && model.path.length > 0,
                'folder-list': model.pagination.totalPage <= 1 && isAllowedFileType('all') && model.path.length > 0,
                'file': model.pagination.totalPage <= 1 && !(isAllowedFileType('all') && model.path.length > 0)}">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div ng-repeat="upload in model.pagination.currentList">
        <div class="row file-list-item" ng-if="upload.is_folder" data-ng-click="!upload.selectable || toggleUploadClick(upload)">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload);"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="true"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i class="font font-file-[[fileTypeByExtension(upload)]]"></i>
            </div>
            <div class="columns file-name" ng-click="enterFolder(upload)" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div class="name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上傳失敗</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="刪除"></i>
                </a>
            </div>
        </div>
        <label class="row file-list-item" ng-if="!upload.is_folder">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload)"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                   class="font font-file-[[fileTypeByExtension(upload)]]"></i>
                <i ng-if="upload.type == 'slide'" class="font font-slide"></i>
                <i ng-if="upload.type == 'subject-lib'" class="font font-resource-subject-lib"></i>
            </div>
            <div class="columns file-name" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div>
                    <span class="name truncate-text">
                        <span ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                              ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                        <span ng-if="upload.type == 'slide' || upload.type == 'subject-lib'"
                              ng-bind="upload.title" tipsy="upload.title"></span>
                    </span>
                    <span class="video-quiz-mark" ng-if="upload.type == 'video-quiz'">互動教材</span>
                    <span ng-if="upload.type != 'slide'" class="extension" ng-bind="upload.name|fileExtension"></span>
                    <span class="video-quiz-warning" ng-if="upload.type == 'video-quiz' && upload.uploads[0].deleted">影片已刪除</span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="刪除"></i>
                </a>
            </div>
        </label>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您還沒有任何檔案
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合條件的檔案
    </div>
</div>
<div class="thumbnail-list" ng-if="model.fileType == 'image' && model.mode == 'thumbnail'">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div class="thumbnail-block">
        <div class="row file-summary clear">
            <div class="large-6 column">
                <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
                       ng-if="!model.singleSelect"/>
                <span ng-if="model.singleSelect">&nbsp</span>
            </div>
            <div class="large-26 columns">
                <div class="view-mode right">
                    <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                        <i class="font font-thumbnail-view"></i>
                    </a>
                    <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                        <i class="font font-list-view"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="clear">
            <div class="thumbnail-label left" ng-repeat="upload in model.pagination.currentList | orderBy: '-created_at'">
                <label>
                    <div class="thumbnail" ng-class="{'selected': upload.selected || upload.id == model.singleSelectedUpload.id, 'single-select': model.singleSelect}">
                        <input type="checkbox" class="thumbnail-input" ng-if="!model.singleSelect" ng-change="toggleUploadClick(upload)" ng-model="upload.selected">
                        <input type="radio" class="thumbnail-input" name="upload" ng-value="upload"
                               ng-model="model.singleSelectedUpload" ng-if="model.singleSelect"/>
                        <img ng-src="/api/third-part/uploads/[[upload.thumbnail.id]]/thumbnail" ng-if="upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/third-part/uploads/[[upload.id]]/preview" ng-if="upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                        <img class="fade" ng-src="/api/uploads/[[upload.thumbnail.id]]/thumbnail?preview=true" ng-if="!upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/uploads/[[upload.id]]/blob?preview=true" ng-if="!upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                    </div>
                </label>
                <div class="file-name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您還沒有任何檔案
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合條件的檔案
    </div>
</div>
<div class="row list-pager" ng-if="model.pagination.totalPage > 1">
    <ul>
        <li ng-show="model.pagination.currentPage > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage - 1)">
                <span>< 上一頁</span>
            </a>
        </li>
        <li class="first-page" ng-hide="model.pagination.currentPage <= 1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage <= 3">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="model.pagination.currentPage <= 2">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage - 1" ng-click="changePage(model.pagination.currentPage - 1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="model.pagination.currentPage"></a>
        </li>
        <li class="next-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 1">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage + 1" ng-click="changePage(model.pagination.currentPage + 1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage">
            <a class="small pager-button button-white" ng-bind="model.pagination.totalPage" ng-click="changePage(model.pagination.totalPage)"></a>
        </li>
        <li ng-show="model.pagination.currentPage < model.pagination.totalPage" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage+1)">
                <span>下一頁 ></span>
            </a>
        </li>
        <li class="custom-pager">
            <span>頁碼:</span>
            <input type="text" name='page' ng-model="model.pagination.inputPage" ng-change="model.verifyPageIndexInput" enter-press="changePage(model.pagination.inputPage)"/>
            <a class="button button-white" ng-click="changePage(model.pagination.inputPage)" ng-disabled="!model.pagination.inputPage">Go</a>
        </li>
    </ul>
</div>                </div>
            </div>
        </div>
        <div id="myFilesUpload">
             <div class="upload-hint in-file-select">
<div class="ipr-message" ng-init="twOrg = true;">
    <div>
        <input type="checkbox" id="upload_hint" ng-model="hasReadIPR">
        <span>我已知悉並遵守</span>
        <a reveal-modal="upload_hint_popup">
            <span>《智慧財產權》</span>
        </a>
        <span>（可點擊）相關規定。</span>
<div class="popup-area reveal-modal popup-900" id="upload_hint_popup" data-reveal
     data-options="multiple_opened:true">
    <div class="popup-content">
        <div class="popup-header">
            智慧財產權
        </div>
        <div class="main-area">
            <div class="tw-org">
                <div>1. 使用教學平台，必須遵守著作權法及相關法律規定。</div>
                <div>2. 上傳具智慧財產權之教材與電子資源，必須事先取得合法使用授權書，並限修課學生線上觀看，請勿提供下載，以免侵權。</div>
                <div>3. 依著作權法《第七章罰則》規定：侵害他人之著作財產權者，處三年以下有期徒刑、拘役，或科或併科新臺幣七十五萬元以下罰金。</div>
                <div>4. 請尊重他人智慧財產權。若有違法情事，當事人須自行負起全部法律責任。</div>
            </div>

        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <a class="button button-green medium" close-popup="upload_hint_popup" ng-click="readIPR()">
                    知道了
                </a>
            </div>
        </div>
    </div>
</div>    </div>
</div>
            </div>
            <div class='storage-info'>
            </div>
        </div>
        <div class="popup-footer">
            <button class="button button-green medium" ng-click="save()" ng-disabled="isUploading() || model.getSelectedUploads().length <= 0 || !hasReadIPR">
                確認
            </button>
        </div>
    </div>
</div><div class="code-editor popup-area new-popup-area popup-1080 reveal-modal" id="code-editor" data-reveal resetable
     data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened" ng-controller="CodeEditorController">
        <div class="popup-header">
            <span>程式碼編輯器</span>
            <a class="right" ng-click="close()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="toolbar">
                <div class="mode-selector">
<select ui-select2="{'formatNoMatches': '沒有符合查詢條件的內容'}"
        ng-model="mode" ng-change="changeMode()">
    <option value="abap">ABAP</option>
    <option value="abc">ABC</option>
    <option value="actionscript">ActionScript</option>
    <option value="ada">ADA</option>
    <option value="alda">Alda</option>
    <option value="apache_conf">Apache Conf</option>
    <option value="apex">Apex</option>
    <option value="aql">AQL</option>
    <option value="asciidoc">AsciiDoc</option>
    <option value="asl">ASL</option>
    <option value="assembly_x86">Assembly x86</option>
    <option value="autohotkey">AutoHotkey / AutoIt</option>
    <option value="batchfile">BatchFile</option>
    <option value="c_cpp">C and C++</option>
    <option value="c9search">C9Search</option>
    <option value="cirru">Cirru</option>
    <option value="clojure">Clojure</option>
    <option value="cobol">Cobol</option>
    <option value="coffee">CoffeeScript</option>
    <option value="coldfusion">ColdFusion</option>
    <option value="crystal">Crystal</option>
    <option value="csharp">C#</option>
    <option value="csound_document">Csound Document</option>
    <option value="csound_orchestra">Csound</option>
    <option value="csound_score">Csound Score</option>
    <option value="css">CSS</option>
    <option value="curly">Curly</option>
    <option value="d">D</option>
    <option value="dart">Dart</option>
    <option value="diff">Diff</option>
    <option value="dockerfile">Dockerfile</option>
    <option value="dot">Dot</option>
    <option value="drools">Drools</option>
    <option value="edifact">Edifact</option>
    <option value="eiffel">Eiffel</option>
    <option value="ejs">EJS</option>
    <option value="elixir">Elixir</option>
    <option value="elm">Elm</option>
    <option value="erlang">Erlang</option>
    <option value="forth">Forth</option>
    <option value="fortran">Fortran</option>
    <option value="fsharp">FSharp</option>
    <option value="fsl">FSL</option>
    <option value="ftl">FreeMarker</option>
    <option value="gcode">Gcode</option>
    <option value="gherkin">Gherkin</option>
    <option value="gitignore">Gitignore</option>
    <option value="glsl">Glsl</option>
    <option value="gobstones">Gobstones</option>
    <option value="golang">Go</option>
    <option value="graphqlschema">GraphQLSchema</option>
    <option value="groovy">Groovy</option>
    <option value="haml">HAML</option>
    <option value="handlebars">Handlebars</option>
    <option value="haskell">Haskell</option>
    <option value="haskell_cabal">Haskell Cabal</option>
    <option value="haxe">haXe</option>
    <option value="hjson">Hjson</option>
    <option value="html">HTML</option>
    <option value="html_elixir">HTML (Elixir)</option>
    <option value="html_ruby">HTML (Ruby)</option>
    <option value="ini">INI</option>
    <option value="io">Io</option>
    <option value="jack">Jack</option>
    <option value="jade">Jade</option>
    <option value="java">Java</option>
    <option value="javascript">JavaScript</option>
    <option value="json">JSON</option>
    <option value="json5">JSON5</option>
    <option value="jsoniq">JSONiq</option>
    <option value="jsp">JSP</option>
    <option value="jssm">JSSM</option>
    <option value="jsx">JSX</option>
    <option value="julia">Julia</option>
    <option value="kotlin">Kotlin</option>
    <option value="latex">LaTeX</option>
    <option value="latte">Latte</option>
    <option value="less">LESS</option>
    <option value="liquid">Liquid</option>
    <option value="lisp">Lisp</option>
    <option value="livescript">LiveScript</option>
    <option value="logiql">LogiQL</option>
    <option value="lsl">LSL</option>
    <option value="lua">Lua</option>
    <option value="luapage">LuaPage</option>
    <option value="lucene">Lucene</option>
    <option value="makefile">Makefile</option>
    <option value="markdown">Markdown</option>
    <option value="mask">Mask</option>
    <option value="matlab">MATLAB</option>
    <option value="maze">Maze</option>
    <option value="mediawiki">MediaWiki</option>
    <option value="mel">MEL</option>
    <option value="mips">MIPS</option>
    <option value="mixal">MIXAL</option>
    <option value="mushcode">MUSHCode</option>
    <option value="mysql">MySQL</option>
    <option value="nginx">Nginx</option>
    <option value="nim">Nim</option>
    <option value="nix">Nix</option>
    <option value="nsis">NSIS</option>
    <option value="nunjucks">Nunjucks</option>
    <option value="objectivec">Objective-C</option>
    <option value="ocaml">OCaml</option>
    <option value="pascal">Pascal</option>
    <option value="perl">Perl</option>
    <option value="pgsql">pgSQL</option>
    <option value="php">PHP</option>
    <option value="php_laravel_blade">PHP (Blade Template)</option>
    <option value="pig">Pig</option>
    <option value="powershell">Powershell</option>
    <option value="praat">Praat</option>
    <option value="prisma">Prisma</option>
    <option value="prolog">Prolog</option>
    <option value="properties">Properties</option>
    <option value="protobuf">Protobuf</option>
    <option value="puppet">Puppet</option>
    <option value="python">Python</option>
    <option value="qml">QML</option>
    <option value="r">R</option>
    <option value="raku">Raku</option>
    <option value="razor">Razor</option>
    <option value="rdoc">RDoc</option>
    <option value="red">Red</option>
    <option value="rhtml">RHTML</option>
    <option value="rst">RST</option>
    <option value="ruby">Ruby</option>
    <option value="rust">Rust</option>
    <option value="sass">SASS</option>
    <option value="scad">SCAD</option>
    <option value="scala">Scala</option>
    <option value="scheme">Scheme</option>
    <option value="scss">SCSS</option>
    <option value="sh">SH</option>
    <option value="sjs">SJS</option>
    <option value="slim">Slim</option>
    <option value="smarty">Smarty</option>
    <option value="smithy">Smithy</option>
    <option value="snippets">snippets</option>
    <option value="soy_template">Soy Template</option>
    <option value="space">Space</option>
    <option value="sql">SQL</option>
    <option value="sqlserver">SQLServer</option>
    <option value="stylus">Stylus</option>
    <option value="svg">SVG</option>
    <option value="swift">Swift</option>
    <option value="tcl">Tcl</option>
    <option value="terraform">Terraform</option>
    <option value="tex">Tex</option>
    <option value="text">Text</option>
    <option value="textile">Textile</option>
    <option value="toml">Toml</option>
    <option value="tsx">TSX</option>
    <option value="twig">Twig</option>
    <option value="typescript">Typescript</option>
    <option value="vala">Vala</option>
    <option value="vbscript">VBScript</option>
    <option value="velocity">Velocity</option>
    <option value="verilog">Verilog</option>
    <option value="vhdl">VHDL</option>
    <option value="visualforce">Visualforce</option>
    <option value="wollok">Wollok</option>
    <option value="xml">XML</option>
    <option value="xquery">XQuery</option>
    <option value="yaml">YAML</option>
    <option value="zeek">Zeek</option>
    <option value="django">Django</option>
</select>                </div>
            </div>
            <pre id="editor"></pre>
        </div>
        <div class="popup-footer">
            <button class="button button-green medium" ng-click="save()"
                    >
                確認
            </button>
        </div>
    </div>
</div></div>        <div class="main-content gtm-category " ng-class="{'has-footer-warning': org_plan_trial == 'True'}"
             auto-scroll-to-last-position data-category="tronclass-content">
    <div class="content-under-nav-1 with-loading"
         ng-init="indexMenuItem='course';
         useCard='false';
         orgId='1';
         szuPageMode=false;
         i18nMessages={'noData': '暫無統計資料'};
         weekDays=['週一', '週二', '週三', '週四', '週五', '週六', '週日'];
         summaryVisitTypes=['造訪量', '訪客數'];
         has_avatar='True';
         associationCode='ZPLAC7'">
        <div class="user-index row collapse">
            <div class="column collapse menu-side" ng-class="{'hide': szuPageMode}">
<div class="user-menu card gtm-category" data-category="左侧导航" ng-cloak>
    <div class="user-info">
        <div class="user-avatar">
            <avatar src="avatarBigUrl"></avatar>
        </div>
        <div class="user-name truncate-text">
            <span ng-bind="currentUserName" tipsy="currentUserName"></span>
        </div>

        <div class="user-role">
            <div ng-switch="currentUserRole" ng-cloak ng-if="currentUserRole">
                <span ng-switch-when="Student">學生</span>
                <span ng-switch-when="Instructor">教師</span>
            </div>
            <div ng-if="!currentUserRole">教師</div>
        </div>
    </div>
    <div class="menu zh-TW" ng-init="isJLU = 'TKU' == 'JLU';">
        <div class="group" ng-if="isJLU">
            <a ng-class="{active: indexMenuItem == 'index'}" ng-href="/user/index" class="gtm-label"
               data-label="首页">
                <i class="icon icon-user-index-index"
                   ng-class="{'icon-user-index-index-selected': indexMenuItem == 'index'}"></i>
                <span>首頁</span>
            </a>
        </div>
        <div class="group">
            <div class="group-name" ng-cloak
                 ng-if="currentUserRole && currentUserRole == 'Student'">我的學習</div>
            <div class="group-name" ng-cloak
                 ng-if="currentUserRole && currentUserRole != 'Student'">我的教學</div>
            <div class="group-name" ng-cloak ng-if="!currentUserRole">
                    我的教學
            </div>

            <a ng-class="{active: indexMenuItem == 'index'}" ng-href="/user/index" class="gtm-label"
               data-label="首页"  ng-if="!isJLU">
                <i class="icon icon-user-index-index"
                   ng-class="{'icon-user-index-index-selected': indexMenuItem == 'index'}"></i>
                <span>首頁</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'course'}" ng-href="/user/courses" class="gtm-label"
               data-label="我的课程">
                <i class="icon icon-user-index-course"
                   ng-class="{'icon-user-index-course-selected': indexMenuItem == 'course'}"></i>
                <span>我的課程</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'online-teaching'}" ng-href="/user/online-teachings/" class="gtm-label"
                data-label="直播教学" ng-if="False">
                <i class="font font-video-new"
                    ng-class="{'selected': indexMenuItem == 'online-teaching'}"></i>
                    <span>直播教學</span>
            </a>
                <a ng-class="{active: indexMenuItem == 'bulletin'}" ng-href="/bulletin-list/" class="gtm-label"
                   data-label="公告">
                    <i class="font font-bulletin"
                       ng-class="{'selected': indexMenuItem == 'bulletin'}"></i>
                        <span>公告</span>
                </a>
            <!-- LMS-5968: 吉大需要将公告导航栏放到最后-->
        </div>

        <div class="group">
            <div class="group-name">我的資源</div>


            <a ng-class="{active: indexMenuItem == 'file'}" ng-href="/user/resources/files" class="gtm-label"
               data-label="文件">
                <i class="icon icon-user-index-resource-file"
                   ng-class="{'icon-user-index-resource-file-selected': indexMenuItem == 'file'}"></i>
                    <span>檔案</span>
            </a>


            <a ng-class="{active: indexMenuItem == 'video-quiz'}" ng-href="/user/resources/video-quizzes"
               class="gtm-label" data-label="互动教材">
                <i class="font font-video-quiz"
                   ng-class="{'icon-user-index-resource-file-selected': indexMenuItem == 'video-quiz'}"></i>
                <span>互動教材</span>
            </a>


            <a ng-class="{active: indexMenuItem == 'subject_lib'}" href="/user/resources/subject-libs"
               class="gtm-label" data-label="个人题库">
                <i class="icon icon-user-index-resource-subject-lib"
                   ng-class="{'icon-user-index-resource-subject-lib-selected': indexMenuItem == 'subject_lib'}"></i>
                <span>個人題庫</span>
            </a>

                <a ng-class="{active: indexMenuItem == 'rubric'}" href="/user/resources/rubrics" class="gtm-label"
                   data-label="Rubrics">
                    <i class="icon icon-user-index-resource-rubric"
                       ng-class="{'icon-user-index-resource-rubric-selected': indexMenuItem == 'rubric'}"></i>
                    <span>Rubrics</span>
                </a>




        </div>



        <div class="group">
            <div class="group-name">帳戶管理</div>
            <a ng-class="{active: indexMenuItem == 'setting'}" ng-href="/user/settings" class="gtm-label"
               data-label="个人设置">
                <i class="icon icon-user-index-setting"
                   ng-class="{'icon-user-index-setting-selected': indexMenuItem == 'setting'}"></i>
                <span>個人設置</span>
            </a>
        </div>
    </div>
</div>            </div>

            <div class="column collapse right-side ng-cloak gtm-category" ng-class="{'card': useCard == 'true',
                'full-screen': szuPageMode}"
                 data-category="右侧内容">
    <div ng-controller="BaseCourseCtrl"
        before-controller="isOpenUniversity=false;
                           platformRoleName='Instructor'"
        ng-init="szuPageMode=false">
<div id="user-join-course-popup" class="reveal-modal popup-area popup-480" data-reveal resetable
     ng-controller="UserJoinCourseCtrl" ng-init="validationError='課程邀請碼錯誤，請確認後重新輸入'" popup-center-location>
    <div class="popup-content">
        <div class="popup-header">
            <span>加入課程</span>
            <a class="right" close-popup="user-join-course-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <label>課程訪問碼</label>
            <div class="access-code">
                <input id="accessCode" type="text" ng-model="accessCode" ng-change="onAccessCodeChange()"/>
                <span class="error" ng-if="error" ng-bind="error"></span>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <a class="button button-green medium" ng-hide="loading"
                   ng-disabled="onRedirecting" ng-click="onRedirecting || join()">
                    加入
                </a>
                <a class="button button-grey medium" ng-hide="loading" close-popup="user-join-course-popup">
                    取消
                </a>
            </div>
        </div>
    </div>
</div><div class="user-courses-container" ng-controller="CourseListCtrl" ng-show="!ui.loading"
     ng-init="orgId='1';">
<div class="teaching-class-header card">
        <div class="operations left">
                <a class="button button-green join-teaching-class" reveal-modal="user-join-course-popup">
                    加入課程
                </a>
        </div>
    <div class="filter-wrapper" ng-init="classifyTypeMap = {
        'recently_started': '最近開課',
        'recently_visited': '最近造訪'}">
        <div class="filter">
            <span class="classify-type-label">排序：</span>
            <a href="javascript:void(0)" toggle-dropdown>
                <span ng-bind="classifyTypeMap[conditions.classify_type]"></span>
                <i class="icon icon-arrow-down"></i>
            </a>

            <div class="dropdown-list zh-TW fit-content classify-type-left hide">
                <ul>
                    <li class="gtm-label" data-label="最近開課">
                        <a ng-click="switchClassifyType('recently_started')">
                            <span>最近開課</span>
                        </a>
                    </li>
                    <li class="gtm-label" data-label="最近造訪">
                        <a ng-click="switchClassifyType('recently_visited')">
                            <span>最近造訪</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="search-section right">
        <div class="search-key">
            <input type="text" class="keyword overflow-hide" ng-model="conditions.keyword"
                   enter-press="search()" wg-placeholder="課程名稱 / 課程代碼">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>查詢</span>
            </a>
        </div>
    </div>
</div>    <div class="user-courses card"
         ng-show="ui.isSearching || ui.isSearchingWithKeyword || result.courses.length > 0 || ui.filterHasDefaultValue">
<div class="loading-in-element" ng-show="contentLoaded">
    <div class="spinner"></div>
</div>
<div class="function-bar" id="init-course-filters" data-init='{"academic_year": null, "class": null, "department": null, "grade": null, "role": null, "semester": null, "status": ["ongoing"]}'>
    <div class="filter-conditions">
<div class="condition">
    <span class="select2-label">學年</span>
    <div class="select2-container">
        <select id="academic-year-select" multi-select multiple="multiple" ng-change="syncSemesters()" responsive="responsive"
                data-title="全部" ng-model="conditions.academic_year_id" ng-init="initAcademicYears()">
            <option value="null">無指定</option>
            <option value="[[ a.id ]]" title="[[a.name]]" ng-repeat="a in academicYears | orderBy : '-sort'"
            ng-bind-html="!a.is_active ? a.name : '<span class=\'multi-select-content-max-width\'>' + a.name + '{0}' | format:['</span><span class=\'info-tag\'>目前</span>'] | trustAsHtml">
            </option>
        </select>
    </div>
</div><div class="condition">
    <span class="select2-label">學期</span>
    <div class="select2-container">
        <select id="semester-select" multi-select multiple="multiple" responsive="responsive"
                data-title="全部" ng-model="conditions.semester_id" ng-init="initSemesters()">
            <option value="null">無指定</option>
            <option value="[[s.id]]" title="[[s.name]]" ng-repeat="s in semesters | orderBy : ['-academic_year_id', 'sort']"
                ng-bind-html="!s.is_active ? s.name : '<span class=\'multi-select-content-max-width\'>' + s.name + '{0}' | format:['</span><span class=\'info-tag\'>目前</span>'] | trustAsHtml"
            ></option>
        </select>
    </div>
</div><div class="condition">
    <span class="select2-label">課程狀態</span>
    <div class="select2-container">
        <select id="course-status-select" multi-select multiple="multiple"
                data-title="全部" ng-model="conditions.status">
            <option value="ongoing">進行中</option>
            <option value="notStarted">即將開課</option>
            <option value="closed">已結束</option>
        </select>
    </div>
</div><div class="condition">
    <span class="select2-label">課程角色</span>
    <div class="select2-container">
        <select id="course-role-select" multi-select multiple="multiple"
                data-title="全部" ng-model="conditions.role">
                <option value="instructor">教師</option>
                <option value="student">學生</option>
                <option value="instructor_assistant">助教</option>
                <option value="student_assistant">學生助教</option>
        </select>
    </div>
</div><div class="condition" ng-init="initDepartments()">
    <span class="select2-label">院系</span>
    <div class="select2-container">
<div class="tree-view">
<div class="tree-container" tree-view="true"
     ng-model="conditions.department_id" tree-model="departments"
     name="course_department_multi_select_tree"
     tree-id="course_department_multi_select_tree" drop-down-menu="" used-for=""
     need-switch-all="" switch-all-tip="全選"
     need-filter=""  keyword-placeholder="請輸入關鍵字" no-results-tip="沒有符合條件的搜尋結果" condition-model=""
     need-default="true" default-id="null" default-name="無指定院系"
     multiple="true" init-select="" stopped_department_tip="(停用)"
     after-click-node="" always-reset-click-event=""
     update-error-message="" hide-drop-down="" trigger-search="">
</div>    <button type="button" class="ui-multiselect ui-widget ui-state-default multi-select" ng-class="{'select-disabled': disabled }">
        <span class="ui-multiselect-open"><span class="ui-icon ui-icon-triangle-1-s"></span></span>
            <span class="title">全部</span>
    </button>
    <span id="default-text" class="hide">全部</span>
</div>    </div>
</div>
<div class="condition">
    <span class="select2-label">年級</span>
    <div class="select2-container">
        <select id="grade-select" multi-select multiple="multiple"
                data-title="全部" ng-model="conditions.grade_id" ng-init="initGrades()">
            <option value="null">無指定</option>
            <option value="[[g.id]]" title="[[g.name]]" ng-repeat="g in grades | orderBy : 'sort'" ng-bind="g.name"></option>
        </select>
    </div>
</div><div class="condition">
    <span class="select2-label">班級</span>
    <div class="select2-container">
        <select id="class-select" multi-select multiple="multiple"
                data-title="全部" ng-model="conditions.class_id" ng-init="initClasses()">
            <option value="null">無指定</option>
            <option value="[[c.id]]" title="[[c.name]]" ng-repeat="c in classes | orderBy : 'sort'" ng-bind="c.name"></option>
        </select>
    </div>
</div>    </div>
<div class="hide">
    <span id="selected-text">已選擇 # 個&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="selected-text-all">全部&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="filter-placeholder">請輸入關鍵字</span>
</div></div>
<ol class="semester-list row" ng-if="result.courses.length > 0">
    <li class="semester">
        <ol class="courses">
            <li class="course" ng-repeat="course in result.courses" ng-class="{'last': $last}"
                ng-click="openCourse(course)" data-course-id="[[course.id]]">
                <div class="item">
                    <div class="course-cover">
                        <img ng-src="[[course.small_cover ? course.small_cover : '/static/assets/images/large/course-cover-default-74db89b7.png']]">
                        <i class="icon icon-course-sample-mark type-marker" ng-if="course.course_type == 2"></i>
                        <div ng-if="course.course_type == 2" class="course-type zh-TW">樣板課程</div>
                        <i class="icon icon-invalid-course-mark type-marker" ng-if="course.course_type == 4"></i>
                        <div ng-if="course.course_type == 4" class="course-type zh-TW">無效課程</div>
                    </div>
                    <div class="course-content">
                        <div class="course-info">
                            <div class="course-title">
                                <span class="course-name" tipsy="course.display_name">
                                    <a ng-bind="course.display_name" tipsy="course.display_name" ng-if="course.isCopying || !canVisitCourse(course)"></a>
                                    <a ng-bind="course.display_name" tipsy="course.display_name" ng-if="!course.isCopying && canVisitCourse(course)" ng-href="[[course.url]]"></a>
                                </span>
                            </div>
                            <div class="course-type" ng-switch="course.course_type">
                                <span class="blueprint-course" ng-switch-when="6">藍本課</span>
                            </div>
                            <div class="audit-status" ng-switch="course.audit_status"
                                 ng-if="canShowAuditStatus(course, 528655)">
                                <span class="status-auditing" ng-switch-when="auditing">審核中</span>
                                <span class="status-agree" ng-switch-when="agree">
                                        <span>公開課</span>
                                </span>
                                <span class="status-reject" ng-switch-when="reject"
                                      tipsy-literal="[[course.audit_remark]]">未通過</span>
                            </div>
                            <div class="course-resubmit" ng-if="canSubmitAuditCourse(course, 528655)">
                                <a confirm-dialog="確認重新繳交審核該課程?"
                                   ng-click="reSubmitAuditCourse($event, course.id)">
                                    重新繳交審核
                                </a>
                            </div>
                            <div class="right" ng-if="course.isCopying">
                                複製中
                            </div>
                        </div>
                        <div class="right" ng-if="!course.isCopying">
                            <div class="course-academic-year-semester">
                                <div class="truncate-text" ng-if="course.semester_id">
                                    <span tipsy="getSemester(course.semester_id)" ng-bind="getSemester(course.semester_id)"></span>
                                </div>
                            </div>
                            <div>
                                <a ng-if="course.isInstructor && !course.isMaster"
                                   ng-click="enterClassmode(course)" stop-propagation
                                   class="enter-classmode">
                                        課堂模式
                                </a>
                                <a stop-propagation class="course-introduction" ng-href="[[course.introductionUrl]]">查看課程介紹</a>
                            </div>
                            <div class="function-buttons">
                                <div class="hover-button">
                                    <i class="font font-delete delete-course" tipsy-literal="刪除課程"
                                       stop-propagation
                                       ng-if="canDeleteCourse(course, 528655, false)"
                                       reveal-modal="delete-course-popup" ng-click="deleteCourse(course)"></i>
                                    <i class="font font-withdraw-course exit-course" stop-propagation
                                       tipsy-literal="退出課程"
                                       ng-if="canWithdrawCourse(course)"
                                       confirm-dialog="確定退出該課程？退出後不可恢復。"
                                       ng-click="withdrawCourse($event, course.id)"></i>
                                    <i class="font font-unmute" stop-propagation
                                       tipsy-literal="消息免打擾"
                                       ng-if="!course.is_mute"
                                       ng-click="openMuteCoursePopup($event, course)"></i>
                                    <i class="font font-stick" stop-propagation
                                        tipsy-literal="置頂"
                                        ng-if="conditions.classify_type == 'recently_started' && !course.user_stick_course_record"
                                        ng-click="stickCourse(course.id)"></i>

                                </div>
                                <div class="mute-button">
                                    <i class="font font-unstick" stop-propagation
                                        tipsy-literal="取消置頂"
                                        ng-if="conditions.classify_type == 'recently_started' && course.user_stick_course_record"
                                        ng-click="unstickCourse(course.id)"></i>
                                </div>
                                <div class="stick-button">
                                    <i class="font font-mute" stop-propagation
                                       tipsy-literal="接收消息提醒"
                                       ng-if="course.is_mute"
                                       ng-click="unmuteCourse($event, course)"></i>
                                </div>
                            </div>
                        </div>
                            <div class="course-code-row truncate-text" ng-if="course.course_code | uuidFilter">
                                <span>課程代碼: </span>
                                <span tipsy="course.course_code" ng-bind="course.course_code | uuidFilter"></span>
                            </div>
                        <div class="course-summarize">
                            <div class="course-summarize-item truncate-text" ng-if="course.department">
                                <span tipsy="course.department.name" ng-bind="course.department.name"></span>
                            </div>
                            <div class="course-summarize-item truncate-text" ng-if="course.grade">
                                <span tipsy="course.grade.name" ng-bind="course.grade.name"></span>
                            </div>
                            <div class="course-summarize-item truncate-text" ng-if="course.klass">
                                <span tipsy="course.klass.name" ng-bind="course.klass.name"></span>
                            </div>
                            <div class="course-summarize-item course-cycle">
                                <span>開課: </span>
                                <span ng-bind="course.start_date"></span>
                                <span ng-if="course.end_date">&nbsp;－&nbsp;課程結束日期: </span>
                                <span ng-if="course.end_date" ng-bind="course.end_date"></span>
                            </div>
                        </div>
                        <div class="course-detail">
                            <div class="detail-row">
                                <div class="teaching-class-name" ng-if="course.course_attributes.teaching_class_name">
                                    <span>授課班級:</span>
                                    <span ng-bind="course.course_attributes.teaching_class_name"
                                          tipsy="course.course_attributes.teaching_class_name"></span>
                                </div>
                                <div class="compulsory"
                                     ng-if="course.compulsory != null && !course.org.is_enterprise_or_organization">
                                    <span>必選修別:</span>
                                    <span ng-switch="course.compulsory">
                                       <span ng-switch-when="true">必修</span>
                                       <span ng-switch-when="false">選修</span>
                                    </span>
                                </div>
                                <div class="credit"
                                     ng-if="course.credit > 0 && !course.org.is_enterprise_or_organization"
                                     ng-class="{'credit-first' : !course.department}">
                                    <span>學分數:</span>
                                    <span ng-bind="course.credit"></span>
                                </div>
                                <div>授課教師:</div>
                                <div class="instructor">
                                    <div class="user-avatar" ng-repeat="instructor in course.instructors.slice(0, 3)">
                                        <div tipsy-literal="[[instructor.name]]" class="avatar16">
                                            <avatar src="instructor.avatar_small_url"></avatar>
                                        </div>
                                    </div>
                                    <span class="user-avatar-overflow"
                                          ng-if="course.instructors.length > 3"
                                          tipsy-literal="[[course.instructorNames]]">...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
        </ol>
    </li>
</ol>
<div id="mute-courses-popup" class="reveal-modal popup-area popup-480" data-reveal resetable>
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span>提示</span>
            <a class="right" close-popup="mute-courses-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="message">
                <span>確定取消接收該課程的動態通知嗎？此操作不會影響課程內容</span>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-hide="loading" ng-click="muteCourse(currentCourse)"
                        type="button">確定</button>
                <button close-popup="mute-courses-popup" class="button button-grey medium" ng-hide="loading"
                        type="button">取消</button>
            </div>
        </div>
    </div>
</div><div id="delete-course-popup" class="reveal-modal popup-area popup-480" data-reveal resetable>
    <div class="popup-content">
        <div class="popup-header">
            <span>刪除課程</span>
            <a class="right" close-popup="delete-course-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="label">
                <label class="required">請輸入課程名稱進行校驗</label>
            </div>
            <div class="course-name">
                <input type="text" ng-model="ui.confirmCourseName" />
                <span class="error" ng-if="ui.confirmDeleteCourseError">名稱錯誤，請重新輸入</span>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-hide="loading" ng-click="confirmDeleteCourse()"
                        type="button">確定</button>
                <button close-popup="delete-course-popup" class="button button-grey medium" ng-hide="loading"
                        type="button">取消</button>
            </div>
        </div>
    </div>
</div><div id="confirmation-popup" class="reveal-modal popup-area confirmation-popup popup-480" data-reveal resetable
     data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
                <span>提示</span>
            <a class="right" close-popup="confirmation-popup" ng-hide="hideCancel" ng-click="cancel()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="message">
                    確定刪除該課程？刪除後不可完全恢復。
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="confirm()"
                        type="submit" ng-hide="loading">確認</button>
                <button class="button button-grey medium" ng-hide="hideCancel" close-popup="confirmation-popup"
                        type="button" ng-hide="loading" ng-click="cancel()">取消</button>
            </div>
        </div>
    </div>
</div><div ng-if="result.pages > 1">
<div class="list-pager">
    <ul>
        <li ng-show="pageIndex > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(pageIndex-1)">
                <span>< 上一頁</span>
            </a>
        </li>
        <li class="first-page" ng-hide="pageIndex<=1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="pageIndex<=1+2">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="pageIndex<=1+1">
            <a class="small pager-button button-white" ng-bind="pageIndex-1" ng-click="changePage(pageIndex-1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="pageIndex"></a>
        </li>
        <li class="next-page" ng-hide="pageIndex>=result.pages-1">
            <a class="small pager-button button-white" ng-bind="pageIndex+1" ng-click="changePage(pageIndex+1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="pageIndex>=result.pages-2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="pageIndex>=result.pages">
            <a class="small pager-button button-white" ng-bind="result.pages" ng-click="changePage(result.pages)"></a>
        </li>
        <li ng-show="pageIndex != result.pages" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(pageIndex+1)">
                <span>下一頁 ></span>
            </a>
        </li>
        <li class="hidden-in-mobile">
            <div class="select2-container page-selector">
                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                    ng-change="updatePageSize(pageSize)" ng-model="pageSize" parse-integer>
                    <option value="[[ number ]]" ng-repeat="number in pageSizeOptions" ng-bind="number"></option>
                </select>
            </div>
        </li>
        <li class="hidden-in-mobile">項 / 頁</li>
        <li class="custom-pager hidden-in-mobile">
            <span>頁碼:</span>
            <input type="text" name='page' ng-model="ui.pageIndexInput" ng-change="verifyPageIndexInput()" enter-press="changePage(ui.pageIndexInput)"/>
            <a class="button button-white" ng-click="changePage(ui.pageIndexInput)" ng-disabled="!ui.pageIndexInput">Go</a>
        </li>
    </ul>
</div></div>    </div>

    <div ng-if="result.courses.length == 0">
<div class="card">
    <div class="blank-prompt-info blank-page">
        <i class="blank-icon font font-subject-blank"></i>
                <div class="blank-message">如果你已經有課程邀請碼，可以在這裡加入課程。</div>
                <a reveal-modal="user-join-course-popup">
                    <button class="blank-button">加入課程</button>
                </a>
    </div>
</div>    </div>
</div>
<div id="course-prepare-remind-popup" class="reveal-modal popup-area popup-480" data-reveal>
    <div class="popup-content">
        <div class="popup-header">
            <span>備課提醒</span>
            <a class="right" close-popup="course-prepare-remind-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="alert">
                <i class="font font-alert-warning"></i>
                <div class="warning">
                    <span>暫時無法進入課程</span>
                </div>
            </div>
            <div class="notice">
                <div class="tips" ng-if="currentCourse">
                    <span>[[ '課程內容還在準備中，請等待關聯主課內容同步完成後，再進入課程。' | format: [currentCourse.master_course.name] ]]</span>
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium" type="button" close-popup="course-prepare-remind-popup">我知道了</button>
            </div>
        </div>
    </div>
</div>    </div>

            </div>
        </div>
    </div>
        </div>
<div class="footer gtm-category" data-category="tronclass-footer" ng-controller="FooterCtrl"
     ng-init="copyright='Copyright © 2023 TronClass. All Rights Reserved. Wisdom Garden Limited'; filingNumber=''" ng-cloak>
    <div class="footer-bd">
        <div class="legality-text-with-footer-message">
<span ng-bind="org.copyright" ng-if="org.copyright"></span>
<span ng-if="!org.copyright">Copyright © 2023 TronClass. All Rights Reserved. Wisdom Garden Limited</span>
<span ng-bind="org.filing_number" ng-if="org.filing_number" ng-class="{'filing-number-text': org.filing_number}"></span>

    <br/>
    <span>最佳使用環境：作業系統 Win 7 以上、MAC OS X。 瀏覽器：Edge、Chrome 55以上、Firefox 50.0以上、Safari 9.0以上。</span>
        </div>
    </div>
</div>    </div>

<!--[if lte IE 8]>
    <script type="text/javascript">
        window.location.href='/browser-warning';
    </script>
<![endif]-->

<!--[if IE 9]>
    <script type="text/javascript">
        window.FileAPI = {
            jsUrl: '/static/js/FileAPI.min.js',
            flashUrl: '/static/swf/FileAPI.flash.swf'
        };
        window.onload = function()
        {
            document.title = "TronClass";
        }
        window.isIE9 = true;
    </script>
<![endif]-->

<script type="text/javascript">
    /*@cc_on
        if (/^10/.test(@_jscript_version)) {
            window.isIE10 = true;
        }
    @*/
</script>
    <script type="text/javascript">
        window.statisticsSettings = {
            userId: "528655",
            orgId: "1",
            departmentId: "833",
                server: "/statistics",
            idleThreshold: "30",
            gaTrackingId: "G-YY6C7VCWEY,G-4EQ9Z50LKC",
            enableMgsQueryCache: false,
            enableIdleWarning: false,
            showIdleWarning: false,
        };
    </script>

    <script src="/static/runtime~js/lms-main-70b18c2c.js" defer></script>
<script src="/static/30381-2a31473d.js" defer></script>
<script src="/static/36708-9f7a83df.js" defer></script>
<script src="/static/70538-e0880ef2.js" defer></script>
<script src="/static/8826-0e54116c.js" defer></script>
<script src="/static/16660-494cc739.js" defer></script>
<script src="/static/85565-4dda9e07.js" defer></script>
<script src="/static/9763-60f9f72b.js" defer></script>
<script src="/static/60111-c493cd5f.js" defer></script>
<script src="/static/96486-80e25a02.js" defer></script>
<script src="/static/53925-6fd2ec22.js" defer></script>
<script src="/static/99123-d178eeaf.js" defer></script>
<script src="/static/98128-9052f725.js" defer></script>
<script src="/static/67344-af7cdc36.js" defer></script>
<script src="/static/83994-91108ee0.js" defer></script>
<script src="/static/83302-8ac0db48.js" defer></script>
<script src="/static/47103-f574bae5.js" defer></script>
<script src="/static/50085-d76e07fd.js" defer></script>
<script src="/static/29739-83901290.js" defer></script>
<script src="/static/56244-028f308b.js" defer></script>
<script src="/static/87591-d9a6bf77.js" defer></script>
<script src="/static/67879-becbcfaf.js" defer></script>
<script src="/static/40758-ae55c790.js" defer></script>
<script src="/static/97316-a6630bef.js" defer></script>
<script src="/static/3755-11ee2296.js" defer></script>
<script src="/static/93604-0add6719.js" defer></script>
<script src="/static/85805-1bfef535.js" defer></script>
<script src="/static/78571-e2c9626d.js" defer></script>
<script src="/static/3251-f465229b.js" defer></script>
<script src="/static/63764-37ad58c9.js" defer></script>
<script src="/static/8468-d69c44de.js" defer></script>
<script src="/static/38466-05e551db.js" defer></script>
<script src="/static/73082-c2fc758f.js" defer></script>
<script src="/static/3944-a0caf614.js" defer></script>
<script src="/static/98035-132d160b.js" defer></script>
<script src="/static/50818-72661e5f.js" defer></script>
<script src="/static/16894-b08cca6c.js" defer></script>
<script src="/static/21155-587f690d.js" defer></script>
<script src="/static/10639-f4133214.js" defer></script>
<script src="/static/25303-b195cc2d.js" defer></script>
<script src="/static/4254-66925198.js" defer></script>
<script src="/static/js/lms-main-ff4b2227.js" defer></script>

    <script type="text/javascript">
        window.onload = () => {
            $(document).foundation();
        };
    </script>

    <script type="text/javascript">
        window.analyticsData = {
            orgName: '淡江大學',
            userId: '528655',
            userName: '陳勇汀'
        }
    </script>

        <script async src="https://www.youtube.com/iframe_api" type="text/javascript"></script>
        <script type="text/javascript">
            function onYouTubeIframeAPIReady() {
               window.youtubeApiReady = true;
            }
        </script>

        <div class="invite-confirm-wrapper">
<div id="invite-confirm" class="reveal-modal popup-area" data-reveal>
    <div class="popup-content" ng-if="popupState.popupOpened" resetable ng-controller="InviteConfirmController">
        <div class="popup-header">
            <span>提示</span>
            <a class="right" close-popup="invite-confirm">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area" ng-if="!error">
            <span ng-if="!joined && teachingUnitType == 'course'">確定接受邀請加入該課程？</span>
            <span ng-if="joined && teachingUnitType == 'course'">您已加入該課程</span>
            <span ng-if="!joined && teachingUnitType == 'teaching_class'">確定接受邀請加入該班級？</span>
            <span ng-if="joined && teachingUnitType == 'teaching_class'">您已加入該班級</span>
        </div>

        <div class="main-area" ng-if="error">
            <span ng-if="error.inviteCancelled">已取消邀請加入課程</span>
            <span ng-if="error.courseDeleted">該課程已被刪除</span>
        </div>

        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button type="submit" id="confirmInvite" class="button button-green medium" ng-if="!error"
                        ng-click="confirm()" ng-hide="loading">確定</button>
                <button class="button button-green medium" ng-if="error" ng-click="toUserIndex()">確定</button>

                <button type="button" class="button button-grey medium" close-popup="invite-confirm">取消</button>
            </div>
        </div>
    </div>
</div>        </div>


        <div class="file-previewer-wrapper">
<div id="file-previewer"  ng-controller="FilePreviewerController" class="pdf-reader-wrapper reveal-modal popup-area" resetable data-reveal data-options="multiple_opened:true">
    <div class="popup-content" ng-class="{'catalog': canGuestPreview == true, 'multiple-uploads': uploads.length > 1, 'scorm':upload.type == 'scorm', 'lesson-resource': upload.type == 'lesson-resource'}">
        <div ng-if="upload.name || upload.file_name" class="pdf-reader-detail">
            <div class="header clearfix">
                <span class="title truncate-text left" ng-if="resource  && resource.open_scope == 'group'">
                    <span ng-bind="resource.name|fileName" tipsy="resource.name"></span>
                </span>
                <span class="title truncate-text left" ng-if="!(resource && resource.open_scope == 'group')">
                    <span ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                </span>
                <span class="file-extension left" ng-bind="upload.name|fileExtension" ng-if="!(resource && resource.open_scope == 'group')"></span>
                <span>
                    <span class="cc-license"
                    ng-class="{'cc-license-default': upload.cc_license_code == 'private'}"
                    ng-if="upload.cc_license_code && upload.cc_license_code == 'private'"
                    tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </span>
                    <a class="cc-license"
                        ng-href="[[upload.cc_license_link]]" target="_blank"
                        ng-class="{'cc-license-default': upload.cc_license_code == 'public_domain'}"
                        ng-if="upload.cc_license_code && upload.cc_license_code != 'private'"
                        tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </a>
                </span>
                <div class="file-preview-view-mode right" ng-if="viewMode.enablePreviewMode(upload)">
                    <input type="radio" name="view-mode" value='preview' id="view-mode" checked="checked" ng-model='viewMode.mode'>
                    <label for='view-mode'> 預覽模式 </label>
                    <input type="radio" name="view-mode" value='normal' id='note-mode' ng-model='viewMode.mode'>
                    <label for='note-mode'> 筆記模式 </label>
                </div>

                <a class="right close" close-popup="file-previewer"><i class="font font-close"></i></a>
            </div>
            <div ng-if="previewType(upload.type) == 'file'" class="content">
<div class="file-previewer" ng-if="upload" ng-cloak>
    <div class="bd clearfix">
        <div class="org-transfer-arrears" ng-if="isOrgArrears && ui.urlLoaded">
            <span>機構套餐已過期或流量不足，暫無法查看該機構資源</span>
        </div>
        <div ng-if="viewMode.mode==='normal'" class="reader-wrapper">
            <div ng-if="!isOrgArrears && ui.urlLoaded" class="reader-wrapper" ng-class="{'full-screen': ui.fullScreen}">
                <div class="toolbar" ng-if="(isIE9 || !(upload.type == 'document' && upload.status == 'ready')) && !wpsPreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="unsupported" ng-if="(isIE9 && upload.type == 'document') || upload.type == 'file' || upload.type == 'wmpkg'">
                    <div class="icon-resource-type">
                        <i class="font font-file-document big-file-font"></i>
                        <div class="file-info" ng-if="upload.status=='uploading'">正在傳輸中</div>
                        <div class="file-info">[[ upload.name ]]</div>
                        <div class="file-info"> 暫無法預覽這個格式的檔案</div>
                        <div class="file-info" ng-if="upload.type == 'wmpkg'"> 旭聯智慧大師封裝檔</div>
                        <div class="file-download-button">
                            <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
                            ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載檔案" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
                            ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載檔案" ng-click="downloadBlob(activity, upload)" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
                            target="_blank" title="下載檔案" download="manual.pdf" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="transcode-unready" ng-if="showTranscodeUnreadyTips(upload)">
                    <div class="icon-resource-type">
                        <div ng-if="upload.status == 'file_locked'">
                            <img ng-src="/static/assets/images/large/file_locked-cf8c5024.png" class="icon-file-locked">
                            <div class="file-info"> 抱歉，該檔案已進行加密故無法預覽，請您下載後檢視</div>
                        </div>

                        <i ng-if="upload.status != 'file_locked'" class="font font-file-[[fileTypeByExtension(upload)]] big-file-font"></i>

                        <div class="file-info" ng-if="upload.status=='uploading'">正在傳輸中</div>
                        <div class="file-info" ng-if="upload.status === 'processing' && uploadStatus[upload.id] === 'processing'"> 正在轉碼中</div>
                        <div class="file-info" ng-if="upload.status === 'failed' || uploadStatus[upload.id] === 'failed'"> 轉碼失敗</div>
                        <div class="file-info" ng-if="upload.status == 'cliping'"> 剪辑中</div>
                        <div class="file-info" ng-if="upload.status == 'clip_failed'"> 剪辑失败</div>
                        <div ng-if="upload.type == 'scorm' && upload.status == 'failed'">
                            <div ng-switch="error.status_code">
                                <span ng-switch-when="SCORM101">imsmanifest.xml 檔案不存在 (請上傳符合 SCORM 1.2 格式的 ZIP 壓縮檔)</span>
                                <span ng-switch-when="SCORM102">不支援的 SCORM 格式或版本 (請上傳符合 SCORM 1.2 格式的 ZIP 壓縮檔)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pdf-container"
                     ng-if="!isIE9 && (upload.type == 'document' && upload.status == 'ready' && !upload.isTextFile && !wpsPreview(upload))">

                    <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="ppt-container"
                     ng-if="wpsPreview(upload)" ng-controller="PreviewModeController">
                    <div id="ppt-viewer" class="ppt-viewer"></div>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="txt-file-container" ng-if="upload.type == 'document' && upload.status == 'ready' && upload.isTextFile">
                    <div class="toolbar">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                    <div class='txt-file-content pre-wrap' ng-bind="upload.textContent" ng-if='upload.textContent'>
                    </div>
                </div>

                <div class="img-container" ng-if="upload.type == 'image' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="!isVisitor" ng-src="[[upload.url || '/api/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && !upload.source" ng-src="[[upload.url || '/anonymous-api/' + activity.id + '/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && upload.source" ng-src="[[upload.imageUrl]]">
                    <img ng-cloak ng-if="isVisitor && !activity && resourceId" ng-src="[['/anonymous-api/shared-resources/' + resourceId + '/preview?preview=true']]">
                </div>
                <div class="video-container" ng-if="(upload.type == 'video' && upload.video_urls) || (upload.type == 'other' && upload.video_url && upload.status == 'ready')">
                        <div id='video' class="video-player">
                            <video class="video-js vjs-default-skin" controls preload="auto" width="100%" height="100%"
                                   video-player
                                   resource="resource"
                                   player-settings="{disableTrack: true}"
                                   allow-right-click="false"
                                   enable-play-rate=True
                                   resolution="upload.video_urls['HD']?'HD':'ORIGINAL'">
<source src="[[ upload.video_urls['ORIGINAL'] | trustSrc]]" label="原始畫質" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['ORIGINAL']" res="ORIGINAL">
<source src="[[ upload.video_urls['HD'] | trustSrc]]" label="1080p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['HD']" res="HD">
<source src="[[ upload.video_urls['VGA'] | trustSrc]]" label="720p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['VGA']" res="VGA">
<source src="[[ upload.video_urls['QVGA'] | trustSrc]]" label="480p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['QVGA']" res="QVGA">                            </video>
                        </div>

                    <div id="cc_video" class="video-player" ng-if="upload.is_cc_video && upload.status == 'ready'"
                         ng-bind-html="upload.play_code | trustAsHtml">
                    </div>
                </div>

                <div class="video-container" ng-if="upload.type == 'other' && upload.page_url && upload.status == 'ready'">
                    <div class="lesson-resource-preview">
                        <iframe id="lessonResourceIframe" frameborder="0"
                                ng-src="[[ trustAsResourceUrl(upload.page_url) ]]"
                                ng-style="iframeStyle"
                                allowfullscreen width="100%" height="100%">
                        </iframe>
                    </div>
                </div>

                <div class="audio-container" ng-if="upload.type == 'audio' && upload.status == 'ready' && audioUrl">
<div class="audio-wrapper" ng-controller="AudioPlayCtrl"
     ng-init="forwardSeekingWarning='教師已設置觀看該影片不能快進';init()"
     before-controller="pauseWhenLeavingWindow = false;">
    <div class="music-note" ng-click="togglePlay($event)">
        <i class="font font-music"></i>
    </div>
    <div class="audio-player-wrapper">
        <div class="play">
            <a ng-click="togglePlay($event)">
                <i class="font" ng-class="ui.isPlaying ? 'font-audio-pause' : 'font-audio-play'"></i>
            </a>
        </div>
        <div class="current-time">
            <span class="current">[[ ui.currentTimeStr ]]</span>
        </div>
        <div class="slider-bar"
             ng-mousemove="refreshPos($event)"
             ng-mouseleave="deleteClass()">
            <div class="audio-slider"></div>
            <div class="audio-slider-mask"
                 ng-style="{width: ui.maskWidth + 'px'}"></div>
            <div class="slider-tip" ng-bind="sliderTip ? sliderTip : forwardSeekingWarning"></div>
            <div class="slider-tip-arrow"></div>
            <div class="slider-tip-line"></div>
        </div>
        <div class="time-divider">
            <span>/</span>
        </div>
        <div class="duration">
            <span>[[ ui.durationStr ]]</span>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && !upload.source">
            <a ng-href="/api/uploads/[[activity.uploads[0].id]]/blob">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && upload.source">
            <a ng-href="[[upload.url]]/download">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="description" ng-if="activity.data['description']">
            <i class="font font-audio-desc"></i>
            <div class="desc-content-wrapper">
                <div class="content-detail simditor-viewer" ng-bind-html="activity.data['description']|sanitizeHtml" mathjax></div>
                <div class="content-arrow"></div>
            </div>
        </div>
        <div class="volume">
            <a ng-click="toggleVolume($event)">
                <i ng-class="ui.isMuting ? 'font-audio-volume-off' : 'font-audio-volume'" class="font"></i>
            </a>
            <div class="volume-slider-wrapper">
                <div class="volume-slider-arrow"></div>
                <div class="volume-slider"></div>
            </div>
        </div>
    </div>
    <audio preload="auto" class="audio">
        <source ng-src="[[audioUrl | trustSrc]]">
    </audio>
</div>                </div>

                <div class="swf-container" ng-if="upload.type == 'swf' && (!upload.status || upload.status != 'uploading')">
                    <div class="swf-player">
                        <div class="loading" ng-hide="!ui.swfLoading"></div>
                        <div ng-if="!isVisitor" swf-object id="preview-flash" swf-url="/api/uploads/[[upload.id]]/swf" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && activity" swf-object id="preview-flash" swf-url="/anonymous-api/[[activity.id]]/uploads/[[upload.id]]/swf?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && !activity && resourceId" swf-object id="preview-flash" swf-url="/anonymous-api/shared-resources/[[resourceId]]/preview?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="!hasFlashPlayer" class="no-flash-player">
                            您還沒有安裝Flash播放器，請點擊
                            <a ng-href="https://get.adobe.com/flashplayer/">這裡</a>
                            安裝
                        </div>
                    </div>
                </div>

                <div class="scorm-container" ng-if="upload.type == 'scorm' && upload.status == 'ready'">
                    <div class="sco-menu">
                        <span ng-bind="scormManifest.organizations.organization.title"></span>
                        <div ng-show="scormManifest.organizations.organization.item.length > 0"
                             ng-repeat="i1 in scormManifest.organizations.organization.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>
<div ng-repeat="i2 in i1.item" class="menu-level2">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                        </div>
                        <div ng-show="scormManifest.organizations.organization.item" class="menu-level1">
                            <span ng-bind="scormManifest.organizations.organization.item.title"
                                  ng-hide="scormManifest.organizations.organization.item.scormUrl"></span>
                            <a ng-click="viewScorm(scormManifest.organizations.organization.item)"
                               ng-bind="scormManifest.organizations.organization.item.title"
                               ng-show="scormManifest.organizations.organization.item.scormUrl"
                               class="sco-link"></a>
                            <div ng-show="scormManifest.organizations.organization.item.item.length > 0"
                                 ng-repeat="i1 in scormManifest.organizations.organization.item.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>
<div ng-repeat="i2 in i1.item" class="menu-level2">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                            </div>
                        </div>
                    </div>
                    <div class="sco-viewer">
                        <iframe id='scorm-viewer' frameborder="0" class="scorm-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="evercam-container" ng-if="upload.type == 'evercam' && upload.status == 'ready'">
                    <div class="evercam-viewer">
                        <iframe id='evercam-viewer' frameborder="0" class="evercam-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="link-container" ng-if="upload.type == 'link'">
                    <div class="video-link-previewer" ng-if="upload.link.embedded_url">
                        <iframe id="iframeplayer"
                                ng-src="[[ trustAsResourceUrl(upload.link.embedded_url) ]]"
                                ng-style="iframeStyle"
                                height="100%" width="100%"
                                marginwidth="0" marginheight="0"
                                scrolling="No" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="link-previewer" ng-if="!upload.link.embedded_url">
                        <div class="icon-resource-type">
                            <i class="font font-open-in-browser big-file-font"></i>
                            <div>
                                <a class="button button-green small" ng-href="[[upload.link.url]]" target="_blank">在瀏覽器中打開</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='preview-mode reader-wrapper' ng-if="viewMode.mode==='preview'" ng-controller="PreviewModeController">
            <iframe id='preview-viewer' width="100%" height='100%' frameborder="0"
                ng-src="[[trustAsResourceUrl(previewDataMap[upload.id])]]">
            </iframe>
        </div>
    </div>
</div>            </div>
            <div ng-if="previewType(upload.type) == 'video-quiz'" class="content" ng-class="{'has-footer': uploads.length > 1}">
<div ng-controller="VideoQuizPreviewController"
     ng-init="subjectTypeMap={
        'single_selection': '單選題',
        'multiple_selection': '複選題',
        'true_or_false': '是非題'};
        useNewPlayer=false;"
     class="video-quiz-preview-container" ng-cloak>
    <div class="video-player-section section" ng-if="upload.status == 'ready' || (upload.status == 'processing' && upload.video_urls)">
        <div class='interaction-container' ng-if="!upload.deleted && !ui.isOrgTransferArrears">
            <div class="video-player">
    <video class="video-js vjs-default-skin" controls preload="auto"
        video-player activity="activity" upload="upload" ng-if="upload.video_urls"
        player-settings="{disableAutoPlay: true, disableTrack: true}"
        player-initiated="playerInitiated(player)"
        allow-foward-seeking="allow_forward_seeking"
        resolution="upload.video_urls['HD']?'HD':'ORIGINAL'"
        data-desc="[[ ui.videoDescription ]]"
        enable-play-rate=True
        data-allow-download='false'>
<source src="[[ upload.video_urls['ORIGINAL'] | trustSrc]]" label="原始畫質" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['ORIGINAL']" res="ORIGINAL">
<source src="[[ upload.video_urls['HD'] | trustSrc]]" label="1080p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['HD']" res="HD">
<source src="[[ upload.video_urls['VGA'] | trustSrc]]" label="720p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['VGA']" res="VGA">
<source src="[[ upload.video_urls['QVGA'] | trustSrc]]" label="480p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['QVGA']" res="QVGA">    </video>

            </div>
            <div class="interaction-subjects subjects-preview" ng-if="ui.isVideoPaused && subjectsForCurrentTime.length > 0">
<div class="exam-paper with-submit" ng-if="!ui.shouldShowAnswerAtTheCurrentTime">
    <div class="subjects-jit-display">
        <div class="subjects" ng-if="isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime">
<div ng-if="subject.isObjective()">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div><div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暫無題目內容' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上傳</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <ol ng-if="subject.sub_subjects.length > 0" class="cloze-sub-subjects"
        sortable="sub-subject" ng-init="parentSubject = subject">
        <li ng-repeat="subSubject in parentSubject.sub_subjects" class="sub-subject-content">
            <div class="sub-subject" style="display: flex;" ng-init="subject = subSubject">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>                <div class="subject-body" style="flex: 1 0 auto;">
                    <ol class="subject-options">
                        <li class="option" ng-class="subject.settings.options_layout"
                            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                            ng-repeat="option in subject.options | orderBy: 'sort'">
                            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                                <span class="left">
                                    <input
                                        type="radio"
                                        ng-value="[[option.id]]"
                                        ng-model="subject.answeredOption"
                                        ng-change="onChangeSubmission(subject)"
                                    />
                                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                                </span>

                                <div class="option-content">
                                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                                </div>
                            </label>
                        </li>
                    </ol>
                </div>
            </div>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">請從右側拖入合適的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" id="drag-node-[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">配對選項</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" id="drag-node-[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>            </li>
        </div>
        <div class="subjects" ng-if="!isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-if="((!subject.hasValidAnswer && !activity.interaction_activity_attributes.repeat_answer) || activity.interaction_activity_attributes.repeat_answer) && !activity.submission_closed">
<div ng-if="subject.isObjective()">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div><div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暫無題目內容' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上傳</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="刪除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)">
            <i class="font font-delete"></i>
        </a>
</span>    </div>

</div>    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <ol ng-if="subject.sub_subjects.length > 0" class="cloze-sub-subjects"
        sortable="sub-subject" ng-init="parentSubject = subject">
        <li ng-repeat="subSubject in parentSubject.sub_subjects" class="sub-subject-content">
            <div class="sub-subject" style="display: flex;" ng-init="subject = subSubject">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>                <div class="subject-body" style="flex: 1 0 auto;">
                    <ol class="subject-options">
                        <li class="option" ng-class="subject.settings.options_layout"
                            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                            ng-repeat="option in subject.options | orderBy: 'sort'">
                            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                                <span class="left">
                                    <input
                                        type="radio"
                                        ng-value="[[option.id]]"
                                        ng-model="subject.answeredOption"
                                        ng-change="onChangeSubmission(subject)"
                                    />
                                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                                </span>

                                <div class="option-content">
                                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                                </div>
                            </label>
                        </li>
                    </ol>
                </div>
            </div>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">隨機</span>
        <span class="prompt-message alert" ng-if="subject.updated">題目內容已更新,請重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填寫&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未儲存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank'">(請依照題目中的填空位置依次填寫答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (計分規則:
                <span ng-if="subject.score_rule == 'single'">按配對正確項各別計分</span>
                <span ng-if="subject.score_rule == 'overall'">有一項配對錯誤則該題不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">請從右側拖入合適的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" id="drag-node-[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">配對選項</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" id="drag-node-[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>            </li>
        </div>
        <i class="font font-close" ng-click="closeForReplay()"></i>
        <div class="operations interaction-operations">
            <a class="button button-green medium" ng-click="submit()">繳交</a>
        </div>
    </div>
</div>
<div class="subjects-jit-display" ng-if="ui.shouldShowAnswerAtTheCurrentTime">
<div class="exam-paper exam-result"
     ng-init="subjectTypeMap={'single_selection': '單選題', 'multiple_selection': '複選題', 'true_or_false': '是非題'}; isInteraction=true">
    <div class="paper-content">
        <div class="exam-subjects">
            <ol class="subjects-jit-display">
                <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-class="subject.type">
                    <div style="display:none;">[[
                        isCorrect = subject.answerState == 1;
                    ]]</div>
<div style="display:none;">[[
    isInstructorViewAndNotSimulatedSubmission = isInstructorView && !submissionData.isSimulated;
    canViewAnswerState = isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed || isInteraction;
    canViewAnswerForInteraction = isInteraction && isCorrect;
    canViewAnswerExplanation = ((isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed) && !isInteraction ) || isInteraction;
    canViewCorrectAnswer = ((isInstructorViewAndNotSimulatedSubmission || !!(exam.is_announce_answer_time_passed && exam.announce_answer_type == 'answer_and_explanation')) && !isInteraction) || canViewAnswerForInteraction;
    canViewAnswerForClassroom = classroom && classroom.is_answer_announced;
    canGiveScore = allowExamScoreMark && !submissionData.isSimulated;
]]</div>
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暫無題目內容' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此題未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答錯誤</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答對</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.score]] 分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(計分規則:按配對正確項各別計分)</span>
                <span ng-if="subject.score_rule == 'overall'">(計分規則:有一項配對錯誤則該題不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="subject.type != 'analysis' && subject.difficulty_level != 'none' && subject.difficulty_level">（難易度:
    <span ng-if="subject.difficulty_level=='hard'">難）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(請依照題目中的填空位置依次填寫答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label>
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>
                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml"
                          class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
    <div class="subject-message"
        ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>備註:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
             ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
            <span>正確答案:</span>
            <span ng-bind="ui.getCorrectOptions(subject)"></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
            <div class="explanation-label">答案解釋:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
            <div class="explanation-label">答案解釋:</div>
            <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暫無題目內容' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此題未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答錯誤</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答對</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.score]] 分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(計分規則:按配對正確項各別計分)</span>
                <span ng-if="subject.score_rule == 'overall'">(計分規則:有一項配對錯誤則該題不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="subject.type != 'analysis' && subject.difficulty_level != 'none' && subject.difficulty_level">（難易度:
    <span ng-if="subject.difficulty_level=='hard'">難）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(請依照題目中的填空位置依次填寫答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body">
  <div class="answer-content" ng-init="getSubjectAnswerState(subject, submissionScoreData)">
    <ol class="subject-answers">
      <li class="answer" ng-repeat="answer in subject.answers | orderBy: 'sort' track by $index">
        <span ng-if="subject.answers.length > 1">
          <span class="sort circle-number" ng-bind-html="$index+1"></span>
        </span>
        <textarea
          class="content"
          type="text"
          ng-model="answer.content"
          disabled="disabled"
          auto-height-textarea
          format-validated
        ></textarea>
        <div class="answer-error" ng-if="canViewAnswerState">
          <span ng-if="!answer.content" class="answer-message tc-tag error">此題未答</span>
          <span ng-if="answer.content && answer.status == -1 " class="answer-message tc-tag error">
            回答錯誤
          </span>
        </div>
      </li>
    </ol>
  </div>
  <div
    class="subject-message"
    ng-if="canViewCorrectAnswer || canViewAnswerForClassroom || (canViewAnswerExplanation && subject.answer_explanation)"
  >
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
      <span>備註:&nbsp</span>
      <span ng-bind="subject.note"></span>
    </div>
    <div
      class="answer-options"
      ng-if="canViewCorrectAnswer || canViewAnswerForClassroom"
      ng-class="{'answer-only':isAnswerOnly(subject)}"
    >
      <span>正確答案:</span>
      <div class="row collapse correct_answer" ng-repeat="correctAnswer in subject.correct_answers">
        <span class="sort circle-number" ng-bind-html="$index+1"></span>
        <ul style="display: inline-grid">
          <li><span ng-bind="correctAnswer.content | unescapeHtmlChar"></span></li>
          <li ng-repeat="alternate in correctAnswer.alternates">
            <span ng-bind="alternate.content | unescapeHtmlChar"></span>
          </li>
        </ul>
      </div>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation">
      <div class="explanation-label">答案解釋:</div>
      <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
    </div>
  </div>
</div></div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暫無題目內容' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此題未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答錯誤</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答對</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.score]] 分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(計分規則:按配對正確項各別計分)</span>
                <span ng-if="subject.score_rule == 'overall'">(計分規則:有一項配對錯誤則該題不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="subject.type != 'analysis' && subject.difficulty_level != 'none' && subject.difficulty_level">（難易度:
    <span ng-if="subject.difficulty_level=='hard'">難）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(請依照題目中的填空位置依次填寫答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body" ng-init="instructorCommentMaxLen=5000;">
    <div class="answer-content">
        <span ng-compile-html="subject.answer | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer short-answer-view" mathjax>
        </span>
    </div>
    <div ng-init="isViewSubmission = true">
            <div class="short-answer-upload-list"
                 ng-init="uploads = subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation tipsy-literal="批改"
               ng-click="openEditor(upload.id, subject)"
               ng-if="canEditByPdfEditor(upload) && subject && isInstructorView">
                <i class="font font-edit"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation tipsy-literal="批改"
               ng-click="openEditor(upload.id, subject)"
               ng-if="canEditByPdfEditor(upload) && subject && isInstructorView">
                <i class="font font-edit"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>    </div>
</div>            </div>
    </div>

    <div class="subject-message" ng-if="subject.answer_explanation && !questionnaire && canViewAnswerExplanation">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>備註:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="explanation" ng-show="subject.answer_explanation">
            <div class="explanation-label">答案解釋:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
    </div>
    <div class="subject-score" ng-if="canGiveScore" ng-init="subject.score_copy = subject.score">
        <span class="field-title">分數：</span>
        <input type="text" name="score" ng-model="subject.score"
               ng-disabled="course.score_published"
               ng-class="{'ng-invalid': subject.error}"
               ng-change="removeError(subject)"
               esc-press="subject.score_copy"
               model-patron="{required: false}"
               submit-callback="autoSaveScore(subject)"
               maxlength="4" float-precision="1" />
        <span class="error score-error" ng-bind="subject.error || ''"></span>
    </div>
    <div class="submission-comment student-view" ng-if="subject.comment && !allowExamEdit && (subject.score !== '' && subject.score >= 0)">
        <div class="teacher-comment">
            <div class="comment-label">教師評語:</div>
            <span class="comment-content" ng-bind="subject.comment"></span>
        </div>
    </div>
    <div class="submission-comment" ng-if="canGiveScore"
         ng-init="bindLeftCommentLength(subject, instructorCommentMaxLen)">
        <span class="field-title">教師評語:</span>
        <div class="comment-area-container" ng-class="{'is-focus': subject.isFocus}" ng-init="subject.isFocus = false;">
            <textarea class="comment-content" rows="6" name="comment"
                      ng-focus="subject.isFocus=true"
                      ng-blur="subject.isFocus=false"
                      ng-model="subject.comment"
                      placeholder="您可以在此輸入評語"
                      content-length-limit="commentContentExceeded(subject, $exceeded, instructorCommentMaxLen)"
                      content-length-max="[[instructorCommentMaxLen]]"
                      model-patron="{required: false, enterToSubmit: false, bindConvertValue: false}"
                      submit-callback="autoSaveSubmissionComment(subject)">
            </textarea>
            <div class="left-count">
                 <span>[[subject.leftCommentLength]]</span>
            </div>
        </div>
    </div>
    <div ng-if="true">
        <div ng-init="isViewSubmission = true">
            <div class="short-answer-marked-upload-list"
                 ng-init="uploads = subject.marked_attachments; isAttachment = true" refresh-on="subject.marked_attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
    <span class="field-title">批改附件</span>
<div class="attachment-header clearfix">
    <div class="attachment-column column large-15">附件名</div>
    <div class="attachment-column column large-10">檔案大小</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)">
    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'">
        <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.name" ng-bind="upload.name|fileName"></span>
        </span>
        <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy="upload.title" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-4" ng-if="!upload.deleted">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span class="attachment-state-failed" ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">轉碼失敗</span>
        <span class="attachment-state-processing" ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">正在轉碼中</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>檔案已刪除</span>
    </div>
    <div class="attachment-column column attachment-size large-10">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.size >= 0 && upload.source != 'LARK'" ng-bind="upload.size|humanizeBytes"></span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



    <div class="attachment-column column large-7">
<span class="attachment-operations right">
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="預覽">
                <i class="font font-table-edit-view"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
               tipsy-literal="預覽" ng-click="downloadBlob(activity, upload, 'view')"
               ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view"></i>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                   tipsy-literal="下載" ng-click="downloadBlob(activity, upload)"
                   ng-if="upload.source != 'LARK' && !upload.reference_id && !upload.deleted && upload.allow_download && upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                </a>
</span>    </div>

</div>    </div>
</div>            </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'matching'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暫無題目內容' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此題未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答錯誤</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答對</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.score]] 分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(計分規則:按配對正確項各別計分)</span>
                <span ng-if="subject.score_rule == 'overall'">(計分規則:有一項配對錯誤則該題不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="subject.type != 'analysis' && subject.difficulty_level != 'none' && subject.difficulty_level">（難易度:
    <span ng-if="subject.difficulty_level=='hard'">難）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(請依照題目中的填空位置依次填寫答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="matching-subject">
        <ul class="matching-list"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort' track by $index">
            <li ng-if="sub_subject.sort == 0">
                <div class="tip-answer">
                    <div>題目</div>
                    <div class="line"></div>
                    <div>答案</div>
                    <div></div>
                </div>
            </li>
            <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                <div ng-if="sub_subject.submittedOptionIds[0] == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div vue-wrapper>
                        <match-subject-info class="answer" :content="subjectAnswer"></match-subject-info>
                    </div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span ng-if="sub_subject.correctOptions[0].id != option.id"
                              class="answer-message tc-tag error">回答錯誤</span>
                    </div>
                </div>
            </li>
            <li ng-if="sub_subject.submittedOptionIds.length == 0">
                <div ng-init="vueParam={subjectDescription: sub_subject.description}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div class="answer" style="height: 48px;"></div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span class="answer-message tc-tag error">此題未答</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="matching-subject" ng-init="getSubjectAnswerState(subject)">
        <div class="correct-answer"
            ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
            <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
                <span>備註:&nbsp</span>
                <span ng-bind="subject.note"></span>
            </div>
            <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
                 ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
                <span>正確答案:</span>
                 <ul class="matching-list"
                ng-class="subject.settings.options_layout"
                ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort'">

                <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                    <div ng-if="sub_subject.correctOptions[0].id == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                        <div vue-wrapper>
                            <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                        </div>
                        <div class="line"><hr/></div>
                        <div vue-wrapper>
                            <match-subject-info class="answer answer-bg" :content="subjectAnswer"></match-subject-info>
                        </div>
                        <div></div>
                    </div>
                </li>
            </ul>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
                <div class="explanation-label">答案解釋:</div>
                <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
                <div class="explanation-label">答案解釋:</div>
                <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
            </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head">
    <div class="summary-title">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.description || '暫無題目內容' | sanitizeHtml" class="pre-wrap exam-subject simditor-viewer" mathjax></span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="subject.score !== ''">
                    <span ng-bind="subject.score"></span>
                    <span>分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
        </span>
          <span ng-if="isInstructorView && !questionnaire">
<span ng-if="subject.type != 'analysis' && subject.difficulty_level != 'none' && subject.difficulty_level">（難易度:
    <span ng-if="subject.difficulty_level=='hard'">難）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>          </span>
    </div>
</div>

<div class="subject-body">
    <ol ng-if="subject.sub_subjects.length > 0" class="cloze-sub-subjects"
        sortable="sub-subject" ng-init="parentSubject = subject">
        <li ng-repeat="subSubject in parentSubject.sub_subjects" class="sub-subject-content">
            <div class="sub-subject" style="display: flex;" ng-init="subject = subSubject">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>                <div class="subject-body">
                    <ol class="subject-options">
                        <li class="option" ng-class="subject.settings.options_layout"
                            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                            ng-repeat="option in subject.options | orderBy: 'sort'">
                            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                                <span class="left">
                                  <input type="radio" ng-checked="option.isChosen" ng-disabled="true"/>
                                  <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                                </span>

                                <div class="option-content">
                                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                                </div>
                            </label>
                        </li>
                    </ol>
                </div>
                 <div class="answer-error" ng-if="canViewAnswerState" ng-init="answerState = getSubjectAnswerState(subject)">
                    <span ng-if="answerState == -1" class="answer-message tc-tag error">此題未答</span>
                    <span ng-if="answerState == 0" class="answer-message tc-tag error">回答錯誤</span>
                </div>
            </div>
        </li>
    </ol>

  <div class="subject-message"
    ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
        <span>備註:&nbsp</span>
        <span ng-bind="subject.note"></span>
    </div>
    <div class="answer-options"
        ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
        <span>正確答案:</span>
        <span class="answer-option" ng-repeat="option in subject.correctOptions">
          ([[option.parent.sort + 1]]) [[ui.intToChar(option.sort)]]&nbsp&nbsp&nbsp
        </span>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
       <div class="explanation-label">答案解釋:</div>
      <div   class="mathjax-process"ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></div>
    </div>
  </div>
</div>

</div>

<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                  ng-compile-html="subject.description || '暫無題目內容' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>                </li>
            </ol>
        </div>
    </div>
</div>    <div class="operations interaction-operations">
        <a class="button button-green medium" ng-show="canContinue()"
           ng-click="continue()">繼續播放</a>
        <a class="button button-green medium" ng-show="activity.interaction_activity_attributes.repeat_answer"
           ng-click="ui.shouldShowAnswerAtTheCurrentTime=false">重新作答</a>
    </div>
</div>            </div>
        </div>
    </div>
<div ng-if="upload">
    <div class="interaction-message" ng-if="upload.status == 'ready' && !upload.deleted && ui.isOrgTransferArrears">
        <span class="attachment-delete-info">機構套餐已過期或流量不足，暫無法查看該機構資源</span>
    </div>
    <div class="interaction-message" ng-if="upload.status == 'ready' && upload.deleted">
        <span class="attachment-delete-info">檔案已刪除</span>
    </div>
    <div class="interaction-message" ng-if="(upload.status == 'processing' && !upload.video_urls) && !upload.deleted">
        <div class="video-in-transcoding-msg">正在轉碼中，請稍候</div>
    </div>
    <div class="interaction-message" ng-if="upload.status == 'failed' && !upload.deleted">
        <div class="video-in-transcoding-msg">轉碼失敗</div>
    </div>
</div></div>            </div>
            <div ng-if="previewType(upload.type) == 'lesson-resource'" class="content" ng-class="{'has-footer': uploads.length > 1}">
                <div class="lesson-resource-preview">
                    <iframe id="lessonResourceIframe" frameborder="0"
                            ng-src="[[ trustAsResourceUrl(lesson_resource_url) ]]"
                            ng-style="iframeStyle"
                            allowfullscreen width="100%" height="100%">
                    </iframe>
                </div>
            </div>
        </div>
    </div>
    <div class="file-previewer-nav" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex - 1)"><i class="icon font font-arrow-left-middle"></i></span>
    </div>
    <div class="file-previewer-nav right" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex + 1)"><i class="icon font font-arrow-right-middle"></i></span>
    </div>
</div>        </div>

    <div class="pdf-editor-wrapper">
<div id="pdf-editor" ng-controller="PdfEditorController"
     class="pdf-reader-wrapper reveal-modal popup-area" resetable data-reveal data-options="multiple_opened:true">
    <div class="popup-content">
        <div class="pdf-reader-detail">
            <div class="header ">
                <div class="header-content">
                    <span class="owner" ng-show="userName">
                        <span class="avatar default"></span>
                        <span tipsy="student">[[userName]]</span>
                    </span>
                    <span ng-show="fileName" class="file-info" ng-bind="fileName" tipsy="fileName">[[fileName]]</span>
                    <span class="header-right">
                        <span class="score-input-label" ng-if="activityData.type=='homework'">
                            <span class="inter-score score-label">成績</span> &nbsp;&nbsp;
                            <input name="score" ng-disabled="activityData.uiOfSubmissionList.inInterScoreList && !activityData.uiOfSubmissionList.noRubric"
                                    ng-model="activityData.score"
                                    focus-placeholder="100"
                                    type="text" server-validated maxlength="4" float-precision="1">
                        </span>
                        <span class="save" ng-click="savePdf(activityData.score)">
                            <i class="font font-save"></i>
                            <span class="inner">儲存批改</span>
                        </span>
                    </span>
                </div>
                <a class="right close" ng-click="openConfirmPopup()"><i class="font font-close"></i></a>
            </div>
            <div class="content" ng-if="activityData.type === 'homework'">
                <div class="file-previewer-nav" ng-if="activityData.uploadsLen > 1">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(-1)}" ng-click="isDisableClick(-1)||changeFile(-1)"><i class="icon font font-arrow-left-middle"></i></span>
                </div>
                <div class="file-previewer-nav right" ng-if="activityData.uploadsLen > 1">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(1)}" ng-click="isDisableClick(1)||changeFile(1)"><i class="icon font font-arrow-right-middle"></i></span>
                </div>
                <div ng-show="!canEditByPdfEditorWithType(fileType)" ng-controller="FilePreviewerController" class="preview" >
<div class="file-previewer" ng-if="upload" ng-cloak>
    <div class="bd clearfix">
        <div class="org-transfer-arrears" ng-if="isOrgArrears && ui.urlLoaded">
            <span>機構套餐已過期或流量不足，暫無法查看該機構資源</span>
        </div>
        <div ng-if="viewMode.mode==='normal'" class="reader-wrapper">
            <div ng-if="!isOrgArrears && ui.urlLoaded" class="reader-wrapper" ng-class="{'full-screen': ui.fullScreen}">
                <div class="toolbar" ng-if="(isIE9 || !(upload.type == 'document' && upload.status == 'ready')) && !wpsPreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="unsupported" ng-if="(isIE9 && upload.type == 'document') || upload.type == 'file' || upload.type == 'wmpkg'">
                    <div class="icon-resource-type">
                        <i class="font font-file-document big-file-font"></i>
                        <div class="file-info" ng-if="upload.status=='uploading'">正在傳輸中</div>
                        <div class="file-info">[[ upload.name ]]</div>
                        <div class="file-info"> 暫無法預覽這個格式的檔案</div>
                        <div class="file-info" ng-if="upload.type == 'wmpkg'"> 旭聯智慧大師封裝檔</div>
                        <div class="file-download-button">
                            <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
                            ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載檔案" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
                            ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載檔案" ng-click="downloadBlob(activity, upload)" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載檔案" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
                            target="_blank" title="下載檔案" download="manual.pdf" class="file-download-content">
                                <i class="font font-download"></i><span>下載檔案</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="transcode-unready" ng-if="showTranscodeUnreadyTips(upload)">
                    <div class="icon-resource-type">
                        <div ng-if="upload.status == 'file_locked'">
                            <img ng-src="/static/assets/images/large/file_locked-cf8c5024.png" class="icon-file-locked">
                            <div class="file-info"> 抱歉，該檔案已進行加密故無法預覽，請您下載後檢視</div>
                        </div>

                        <i ng-if="upload.status != 'file_locked'" class="font font-file-[[fileTypeByExtension(upload)]] big-file-font"></i>

                        <div class="file-info" ng-if="upload.status=='uploading'">正在傳輸中</div>
                        <div class="file-info" ng-if="upload.status === 'processing' && uploadStatus[upload.id] === 'processing'"> 正在轉碼中</div>
                        <div class="file-info" ng-if="upload.status === 'failed' || uploadStatus[upload.id] === 'failed'"> 轉碼失敗</div>
                        <div class="file-info" ng-if="upload.status == 'cliping'"> 剪辑中</div>
                        <div class="file-info" ng-if="upload.status == 'clip_failed'"> 剪辑失败</div>
                        <div ng-if="upload.type == 'scorm' && upload.status == 'failed'">
                            <div ng-switch="error.status_code">
                                <span ng-switch-when="SCORM101">imsmanifest.xml 檔案不存在 (請上傳符合 SCORM 1.2 格式的 ZIP 壓縮檔)</span>
                                <span ng-switch-when="SCORM102">不支援的 SCORM 格式或版本 (請上傳符合 SCORM 1.2 格式的 ZIP 壓縮檔)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pdf-container"
                     ng-if="!isIE9 && (upload.type == 'document' && upload.status == 'ready' && !upload.isTextFile && !wpsPreview(upload))">

                    <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="ppt-container"
                     ng-if="wpsPreview(upload)" ng-controller="PreviewModeController">
                    <div id="ppt-viewer" class="ppt-viewer"></div>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="txt-file-container" ng-if="upload.type == 'document' && upload.status == 'ready' && upload.isTextFile">
                    <div class="toolbar">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="縮小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆時針旋轉" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="復原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下載" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId))"
       ng-href="[[upload.url ? upload.url : '/api/uploads/'+upload.id+'/blob' ]]" title="下載" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下載">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下載" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen()"
       title="全螢幕模式">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全螢幕">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在瀏覽器中打開">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                    <div class='txt-file-content pre-wrap' ng-bind="upload.textContent" ng-if='upload.textContent'>
                    </div>
                </div>

                <div class="img-container" ng-if="upload.type == 'image' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="!isVisitor" ng-src="[[upload.url || '/api/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && !upload.source" ng-src="[[upload.url || '/anonymous-api/' + activity.id + '/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && upload.source" ng-src="[[upload.imageUrl]]">
                    <img ng-cloak ng-if="isVisitor && !activity && resourceId" ng-src="[['/anonymous-api/shared-resources/' + resourceId + '/preview?preview=true']]">
                </div>
                <div class="video-container" ng-if="(upload.type == 'video' && upload.video_urls) || (upload.type == 'other' && upload.video_url && upload.status == 'ready')">
                        <div id='video' class="video-player">
                            <video class="video-js vjs-default-skin" controls preload="auto" width="100%" height="100%"
                                   video-player
                                   resource="resource"
                                   player-settings="{disableTrack: true}"
                                   allow-right-click="false"
                                   enable-play-rate=True
                                   resolution="upload.video_urls['HD']?'HD':'ORIGINAL'">
<source src="[[ upload.video_urls['ORIGINAL'] | trustSrc]]" label="原始畫質" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['ORIGINAL']" res="ORIGINAL">
<source src="[[ upload.video_urls['HD'] | trustSrc]]" label="1080p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['HD']" res="HD">
<source src="[[ upload.video_urls['VGA'] | trustSrc]]" label="720p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['VGA']" res="VGA">
<source src="[[ upload.video_urls['QVGA'] | trustSrc]]" label="480p" type="[[ upload.video_src_type ]]"
        ng-if="upload.video_urls['QVGA']" res="QVGA">                            </video>
                        </div>

                    <div id="cc_video" class="video-player" ng-if="upload.is_cc_video && upload.status == 'ready'"
                         ng-bind-html="upload.play_code | trustAsHtml">
                    </div>
                </div>

                <div class="video-container" ng-if="upload.type == 'other' && upload.page_url && upload.status == 'ready'">
                    <div class="lesson-resource-preview">
                        <iframe id="lessonResourceIframe" frameborder="0"
                                ng-src="[[ trustAsResourceUrl(upload.page_url) ]]"
                                ng-style="iframeStyle"
                                allowfullscreen width="100%" height="100%">
                        </iframe>
                    </div>
                </div>

                <div class="audio-container" ng-if="upload.type == 'audio' && upload.status == 'ready' && audioUrl">
<div class="audio-wrapper" ng-controller="AudioPlayCtrl"
     ng-init="forwardSeekingWarning='教師已設置觀看該影片不能快進';init()"
     before-controller="pauseWhenLeavingWindow = false;">
    <div class="music-note" ng-click="togglePlay($event)">
        <i class="font font-music"></i>
    </div>
    <div class="audio-player-wrapper">
        <div class="play">
            <a ng-click="togglePlay($event)">
                <i class="font" ng-class="ui.isPlaying ? 'font-audio-pause' : 'font-audio-play'"></i>
            </a>
        </div>
        <div class="current-time">
            <span class="current">[[ ui.currentTimeStr ]]</span>
        </div>
        <div class="slider-bar"
             ng-mousemove="refreshPos($event)"
             ng-mouseleave="deleteClass()">
            <div class="audio-slider"></div>
            <div class="audio-slider-mask"
                 ng-style="{width: ui.maskWidth + 'px'}"></div>
            <div class="slider-tip" ng-bind="sliderTip ? sliderTip : forwardSeekingWarning"></div>
            <div class="slider-tip-arrow"></div>
            <div class="slider-tip-line"></div>
        </div>
        <div class="time-divider">
            <span>/</span>
        </div>
        <div class="duration">
            <span>[[ ui.durationStr ]]</span>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && !upload.source">
            <a ng-href="/api/uploads/[[activity.uploads[0].id]]/blob">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && upload.source">
            <a ng-href="[[upload.url]]/download">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="description" ng-if="activity.data['description']">
            <i class="font font-audio-desc"></i>
            <div class="desc-content-wrapper">
                <div class="content-detail simditor-viewer" ng-bind-html="activity.data['description']|sanitizeHtml" mathjax></div>
                <div class="content-arrow"></div>
            </div>
        </div>
        <div class="volume">
            <a ng-click="toggleVolume($event)">
                <i ng-class="ui.isMuting ? 'font-audio-volume-off' : 'font-audio-volume'" class="font"></i>
            </a>
            <div class="volume-slider-wrapper">
                <div class="volume-slider-arrow"></div>
                <div class="volume-slider"></div>
            </div>
        </div>
    </div>
    <audio preload="auto" class="audio">
        <source ng-src="[[audioUrl | trustSrc]]">
    </audio>
</div>                </div>

                <div class="swf-container" ng-if="upload.type == 'swf' && (!upload.status || upload.status != 'uploading')">
                    <div class="swf-player">
                        <div class="loading" ng-hide="!ui.swfLoading"></div>
                        <div ng-if="!isVisitor" swf-object id="preview-flash" swf-url="/api/uploads/[[upload.id]]/swf" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && activity" swf-object id="preview-flash" swf-url="/anonymous-api/[[activity.id]]/uploads/[[upload.id]]/swf?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && !activity && resourceId" swf-object id="preview-flash" swf-url="/anonymous-api/shared-resources/[[resourceId]]/preview?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="!hasFlashPlayer" class="no-flash-player">
                            您還沒有安裝Flash播放器，請點擊
                            <a ng-href="https://get.adobe.com/flashplayer/">這裡</a>
                            安裝
                        </div>
                    </div>
                </div>

                <div class="scorm-container" ng-if="upload.type == 'scorm' && upload.status == 'ready'">
                    <div class="sco-menu">
                        <span ng-bind="scormManifest.organizations.organization.title"></span>
                        <div ng-show="scormManifest.organizations.organization.item.length > 0"
                             ng-repeat="i1 in scormManifest.organizations.organization.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>
<div ng-repeat="i2 in i1.item" class="menu-level2">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                        </div>
                        <div ng-show="scormManifest.organizations.organization.item" class="menu-level1">
                            <span ng-bind="scormManifest.organizations.organization.item.title"
                                  ng-hide="scormManifest.organizations.organization.item.scormUrl"></span>
                            <a ng-click="viewScorm(scormManifest.organizations.organization.item)"
                               ng-bind="scormManifest.organizations.organization.item.title"
                               ng-show="scormManifest.organizations.organization.item.scormUrl"
                               class="sco-link"></a>
                            <div ng-show="scormManifest.organizations.organization.item.item.length > 0"
                                 ng-repeat="i1 in scormManifest.organizations.organization.item.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>
<div ng-repeat="i2 in i1.item" class="menu-level2">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                            </div>
                        </div>
                    </div>
                    <div class="sco-viewer">
                        <iframe id='scorm-viewer' frameborder="0" class="scorm-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="evercam-container" ng-if="upload.type == 'evercam' && upload.status == 'ready'">
                    <div class="evercam-viewer">
                        <iframe id='evercam-viewer' frameborder="0" class="evercam-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="link-container" ng-if="upload.type == 'link'">
                    <div class="video-link-previewer" ng-if="upload.link.embedded_url">
                        <iframe id="iframeplayer"
                                ng-src="[[ trustAsResourceUrl(upload.link.embedded_url) ]]"
                                ng-style="iframeStyle"
                                height="100%" width="100%"
                                marginwidth="0" marginheight="0"
                                scrolling="No" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="link-previewer" ng-if="!upload.link.embedded_url">
                        <div class="icon-resource-type">
                            <i class="font font-open-in-browser big-file-font"></i>
                            <div>
                                <a class="button button-green small" ng-href="[[upload.link.url]]" target="_blank">在瀏覽器中打開</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='preview-mode reader-wrapper' ng-if="viewMode.mode==='preview'" ng-controller="PreviewModeController">
            <iframe id='preview-viewer' width="100%" height='100%' frameborder="0"
                ng-src="[[trustAsResourceUrl(previewDataMap[upload.id])]]">
            </iframe>
        </div>
    </div>
</div>                </div>
                <iframe ng-if="canEditByPdfEditorWithType(fileType)" allowfullscreen="allowfullscreen" id="pdfEditorIframe" ng-src="[[documentUrl]]" frameborder="0" width="100%"
                        height="100%" iframeonload="iframeOnload()"></iframe>
            </div>
            <div class="content" ng-if="activityData.type !== 'homework'">
                <div class="file-previewer-nav" ng-if="activityData.uploadsLen > 1 && activityData.type=='exam'">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(-1)}" ng-click="isDisableClick(-1)||changeFile(-1)"><i class="icon font font-arrow-left-middle"></i></span>
                </div>
                <div class="file-previewer-nav right" ng-if="activityData.uploadsLen > 1 && activityData.type=='exam'">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(1)}" ng-click="isDisableClick(1)||changeFile(1)"><i class="icon font font-arrow-right-middle"></i></span>
                </div>
                <iframe ng-if="canEditByPdfEditorWithType(fileType)" allowfullscreen="allowfullscreen" id="pdfEditorIframe" ng-src="[[documentUrl]]" frameborder="0" width="100%"
                        height="100%" iframeonload="iframeOnload()"></iframe>
            </div>
        </div>
    </div>
    <div class="popup-close" ng-if="isConfirmPopupOpen">
        <div class="content">
            <div class="popup-header">
                <span>退出</span>
            </div>
            <div class="main-area">
                <span ng-if="isPdfChanged">您的更改尚未儲存，確定要離開嗎？</span>
                <span ng-if="!isPdfChanged">您確定要離開嗎？</span>
            </div>
            <div class="popup-footer">
                <div class="form-buttons">
                    <button type="button" class="button button-green medium"
                            ng-click="exitPdfEditor()">確定</button>
                    <button type="button" class="button button-grey medium"
                            ng-click="cancelExitPdfEditor()">取消</button>
                </div>
            </div>
        </div>
    </div>
    <div class="loader-bg" ng-if="loading">
        <div class="loader"></div>
    </div>
</div>    </div>

    

    <div class="cornerButtonGroup" corner-button-group></div>
    <div class="corner-main" ng-if="showCornerButton">
        <div class="corner-container">
            <div class="button-group" scroll-to-top ng-if="showBackToTopButton">
                <div class="button-background back-up-to-top"></div>
                <i class="icon icon-back-to-top" style="position:relative;left:50%;"></i>
            </div>


        </div>
    </div>


<div id="switch-audio-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal resetable ng-controller="SwitchAudioPopupController">
    <div class="popup-content">
        <div class="popup-header">
            <span>切換播放音檔</span>
            <a class="right" close-popup="switch-audio-confirmation-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="message">
                <b>您是否確定執行 <span class="warning-color">［切換播放音檔］</span>？</b><br><br>
                <p class="little">
                    正在播放的音檔將被強制結束，<br>
                    剩餘播放次數： <span ng-bind="currentAudioScope.left_times"></span><br>
                </p>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button type="submit" class="button button-green medium"
                        ng-hide="loading" ng-click="confirm()" close-popup="switch-audio-confirmation-popup">確定</button>
                <button type="button" class="button button-grey medium" close-popup="switch-audio-confirmation-popup">取消</button>
            </div>
        </div>
    </div>
</div>
<div id="idle-warning-popup" class="reveal-modal popup-area popup-480" resetable data-reveal>
    <div class="popup-content">
        <div class="popup-header">
            <span>溫馨提醒</span>
            <a class="right" close-popup="idle-warning-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area" ng-switch="ui.wizardStep">
            <div class="message">
                <span>哈囉，您還在螢幕前嗎？請不要閒置超過30分鐘。系統會判斷您已離席，課程訪問時間將自動停止計算喔！</span>
            </div>
        </div>
        <div class="popup-footer card-footer text-center">
            <span>
                <a class="button button-green medium edit-page" close-popup="idle-warning-popup"
                    onclick="closeIdleWarningPopup();">好</a>
            </span>
        </div>
    </div>
</div>
<script>
    const closeIdleWarningPopup = function () {
      window.statisticsSettings.showIdleWarning = false;
      $("#idle-warning-popup").foundation("reveal", "close");
    }
</script></body>
</html>